\documentclass[a4j,fleqn,10pt]{jsarticle}
\usepackage{ipsj}
\usepackage{txfonts}
\usepackage[symbol*,perpage]{footmisc}
\usepackage[dvipdfm]{graphicx, color}
%\usepackage[format=hang]{caption}
\usepackage{hangcaption}
\renewcommand{\caption}{\hangcaption}

%-------------------------------------------jtitle and jauthors information
\begin{document}

\jtitle{誤りパターン埋込み型ステガノグラフィに関する一考察}
\jcontact{松江工業高等専門学校\dag}
\jauthor{索手 一平\dag}

\maketitle

%-------------------------------------------document
\section{はじめに}
本研究はテキスト情報をグレースケール画像に埋め込むようなステガノグラフィ
技術を対象とする．本研究では代表的な埋め込み方式であるLSB法の改良版であ
る誤りパターン埋込み法における画質劣化と埋め込み率のトレードオフ関係を実
験的に明らかにした．また，その実験結果をもとに画質劣化の起こりやすい画像
の特性について実験し考察を行った．

\section{ステガノグラフィ}
ステガノグラフィとはある情報を他のデータに埋め込む技術・研究分野の総称
であり，これによって情報が埋め込まれていること自体を隠すことができるため
主に秘密情報の伝達において利用されている．ステガノグラフィ技術ではその特
徴からなるべく多くの情報を埋め込めること，そして情報が隠蔽されていること
を主観的・客観的に認知されないことが重要となる．

\section{LSB法}
LSB法とはステガノグラフィ技術の最も代表的な埋め込み方式の一つである．こ
の手法はカバーデータのLSB平面をテキスト情報のバイナリ表現とそのまま置き
換えることによって，情報の埋め込みを行う．アルゴリズムが単純であり実装が
容易であるがその一方で埋め込み後に発生する誤りビットに多くなりやすく，画像の劣化を招きやすいという欠点がある．

\section{誤りパターン埋め込み法}
誤りパターン埋め込み法とはLSB法を元に考案された手法である．この手法では
テキスト情報をより冗長でハミング重みの小さなビット列である誤りパターンに
変換し，誤りパターンと画像のビット列との排他的論理和でビット列を置き換える
ことによって，情報の埋め込みを行う．LSB法に比べ誤りビットが少なくなるた
め画質の劣化を招きにくくなるが，より冗長なビット列に変換することから埋め
込める情報量が少なくなるという欠点がある．

\section{誤りパターンへの変換方法}
誤りパターンへの変換方法の一つに埋め込みデータと誤りパターンを対応付けた
テーブルを用意する方法が知られている．しかし，この方法の問題点として埋め
込みデータの大きさに比例してテーブルが膨大となりメモリ制約の大きい環境で
の実装が困難になるという点があげられる\cite{Paper01}．そこで本研究ではShalkwijkの数え
上げ符号\cite{Paper02}を用いた埋め込みデータから誤りパターンを動的に生成
する手法を提案する．


\section{埋め込み率と画質劣化のトレードオフ関係について}\label{sec:experiment1}
実験手順の概要を図\ref{fig:experiment_outline1}に示す．実験手順は以下のとおりである．実験には
256$\times$256pxの8bitグレイスケールBitmapである自然画像100枚を使用した．また，埋め込み
に使用するメッセージはほぼ当確率で発生する8bitコードの列とした．
\begin{enumerate}
\renewcommand{\labelenumi}{(\arabic{enumi})}
 \item メッセージの各コードをShalkwijkの数え上げ符号を用いて動的に誤りパターン
       へと変換し，画像のビット列との排他的論理和を埋め込む．
 \item 埋め込み前後の画像を比較し，誤り率，PSNR，SSIMを算出する．
 \item 誤りパターン長を8〜256bit、埋め込み範囲をLSBのみから全ビットまでの範
       囲で変化させながら（１），（２）を繰り返す．
 \item 画像を入れ替えて（３）を繰り返す．
\end{enumerate}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=8cm]{img/experiment1.png}
 \end{center}
 \caption{実験概要1}
 \label{fig:experiment_outline1}
\end{figure}

\section{結果と考察}
各画像ごとのSSIMの変化についてのグラフを図\ref{fig:graph_ssim}に示す．図\ref{fig:graph_ssim}から各画像ごとに
メッセージの埋め込み料に対する画質劣化の速度に差があることがわかる。これ
について主観的に観察を行ったところ，近しい画素値が連続して構成される領域が大きけ
れば大きいほど画質劣化が大きくなることがわかった．その例を図\ref{fig:degration-low}，図\ref{fig:degration-high}に示す．
図\ref{fig:degration-low}はさまざまな画素値を持つピクセルが混ざり合った画像であり、一方で図\ref{fig:degration-high}
は画像中の約３分の１を黒い服が占めている。これを客観的に評価するために次の実験を行った．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=8cm]{img/img_ssim.png}
 \end{center}
 \caption{画像ごとのSSIMの遷移}
 \label{fig:graph_ssim}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=4cm]{img/BRIDGE.png}
  \includegraphics[width=4cm]{img/10_15_BRIDGE.png}
 \end{center}
 \caption{劣化の少ない画像（左：埋め込み前　右：埋め込み後）}
 \label{fig:degration-low}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=4cm]{img/milkdrop256.png}
  \includegraphics[width=4cm]{img/10_15_milkdrop256.png}
 \end{center}
 \caption{劣化の大きい画像（左：埋め込み前　右：埋め込み後）}
 \label{fig:degration-high}
\end{figure}


\section{画素値の集中具合の検証実験}
実験手順の概要を図\ref{fig:experiment_outline2}に示す．実験手順は以下のとおりである．

\begin{enumerate}
\renewcommand{\labelenumi}{(\arabic{enumi})}
 \item グレースケールの画像に対し、画素値８ごとに画素を抽出し、抽出した
       画素とそれ以外の画素とで二値化を行う。これにより32枚の2値画像を生
       成する．
 \item 二値化した画素に対し４近傍でラベリング処理を行い、各ラベルのつい
       た猟奇の面積を計算する．
 \item 32枚全ての面積の中で最大の面積を求める．
 \item (1)〜(3)をすべての画像に対し繰り返す．
 \item (4)で算出した最大面積と第\ref{sec:experiment1}節で算出したSSIMとのピアソンの相関係数を算出する．
\end{enumerate}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=8cm]{img/experiment2.png}
 \end{center}
 \caption{実験概要2}
 \label{fig:experiment_outline2}
\end{figure}

\section{結果と考察}
上記の実験を行った結果，約0.6という相関が得られた．
これまでの実験から近しい画素値の大きい集合をもつ画像ほど画質の視覚的な画
質劣化が大きくなるという結果が得られた．これは画素間のコントラストが大き
いほどメッセージ埋め込み後の画素値変化が目立ちにくいため得られたのだと考
えられる．

%-------------------------------------------etitle and eauthors information
\footnotetext[0]{\hspace*{-5.2mm}A study on steganography based on embedding error patterns}
\footnotetext[1]{\hspace*{-6.5mm}\dag Ippei Nawate}
\footnotetext[2]{\hspace*{-6.5mm}\dag Matsue College Of Technology}

%-------------------------------------------references
\bibliographystyle{junsrt}
\bibliography{draft}

\end{document}
