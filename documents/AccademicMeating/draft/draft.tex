\documentclass[a4j,fleqn,10pt]{jsarticle}
\usepackage{ipsj}
\usepackage{txfonts}
\usepackage[symbol*,perpage]{footmisc}
\usepackage[dvipdfm]{graphicx, color}

%-------------------------------------------jtitle and jauthors information
\begin{document}

\jtitle{誤りパターン埋込み型ステガノグラフィに関する一考察}
\jcontact{松江工業高等専門学校\dag}
\jauthor{索手 一平\dag \and 福岡久雄\dag}

\maketitle

%-------------------------------------------document
\section{はじめに}{
 ステガノグラフィとは秘密データをメディアデータに埋め込む技術，研究分野
の総称である．通常，秘密データの通信は暗号化技術によって暗号化し，それ
を送り合うという形になる．しかし，この方法では秘密データの内容そのものを隠
ぺいすることはできても通信行為そのものは他者に認知されてしまい，通信妨害
などの危険を排除することはできない．一方，ステガノグラフィではメディアデー
タの冗長性を利用して秘密データを埋め込むことで通信行為そのものを隠ぺいす
ることができる．

 しかし，冗長性を利用しているとはいえ秘密データを埋め込むことによりメディ
アデータの質は劣化する．ステガノグラフィではその性質からできるだけ多くのデー
タを埋め込むこと，埋め込みが主観的・客観的に認知されないことが求められる．

 本研究ではグレースケール画像にテキスト情報を埋め込むようなステガノグラフィ
技術を対象とし，誤りパターン埋込み法における画質劣化と埋め込み率とのトレー
ドオフ関係を実験的に明らかにする．
}

\section{埋め込み手法}
 ステガノグラフィ技術におけるは代表的な埋め込み方式の一つにLSB法がある．
この手法では秘密データのバイナリ表現をメディアデータのLSB平面とそのまま
置き換えることによって埋め込みを行う．この手法はアルゴリズムが単純であり
多くの情報メディアデータに埋め込むことができるほか，LSBのみへ埋め込みを
行うことからメディアデータの品質劣化が少ない．一方で埋め込みによるLSBの
変化に対して考慮されていないことからLSB以外への埋め込みが難しいという問
題がある．ここで，埋め込みに使用したビット列長に対し，埋め込んだデータ量
の割合を埋め込み率，変化したビットの割合を誤り率という．

 上記のことからLSB法の誤り率を改善したいくつか手法が提案されてきた．その
一つとして誤りパターン埋め込み法が知られており，優れた誤り率を持つ．この
手法ではテキスト情報をより冗長でハミング重みの小さいビット列である誤りパ
ターンに変換し，誤りパターンと画像のLSB平面との排他的論理和でLSB平面を置
き換える．冗長なビット列を使用することからLSB法に比べより低い誤り率を実
現している．しかし，１データの埋め込みにより長いのビット列を必要とするこ
とから埋め込み率についてはLSB法に劣ってしまう．

\section{誤りパターンへの変換における問題}
 誤りパターンへの変換方法の一つに埋め込みデータと誤りパターンを対応付けた
テーブルを用意する方法が知られている．しかし，埋め込みデータの大きさをm
とすると$2^m$個の要素を対応付けたテーブルが必要となり，テーブルが膨大と
なりやすいことからメモリ制約の大きい環境での実装が困難になるという問題点
があげられる\cite{Paper01}．そこで本研究ではShalkwijkの数え上げ符号
\cite{Paper02}を用いた埋め込みデータから誤りパターンを動的に生成する手法
を提案する．

%\section{Shalkwijkの数え上げ符号}

\section{実験方法}\label{sec:experiment}
実験手順の概要を図\ref{fig:experiment_outline1}に示す．以下に示す手順で
実験を行った．実験には256$\times$256pxの8bitグレイスケールBitmapである自然
画像100枚を使用し，埋め込みに使用するメッセージはほぼ当確率で発
生する8bitコードの列とした．

\begin{enumerate}
\renewcommand{\labelenumi}{(\arabic{enumi})}
 \item メッセージの各コードをShalkwijkの数え上げ符号を用いて動的に誤りパターン
       へと変換し，画像のLSB平面との排他的論理和を埋め込む．
 \item 埋め込み前後の画像を比較し，誤り率，SSIMを算出する．ここで
       誤り率rは埋め込み前後で変化したビットの数をd，埋め込みに使用した
       ビットの数をnとして式（\ref{equ:error_rate}）で算出する．
       \begin{equation}\label{equ:error_rate}
         r = \frac{d}{n}\times100
       \end{equation}
 \item 誤りパターン長を8bitから256bitまで変化させ（１），（２）を繰り返す．
 \item 画像を入れ替えて（３）を繰り返す．
\end{enumerate}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=8cm]{img/experiment1.png}
 \end{center}
 \caption{実験概要1}
 \label{fig:experiment_outline1}
\end{figure}

\section{実験結果}
埋め込み率による誤り率の変化のグラフを図\ref{fig:graph_error_rate}に、埋め込み率
による画像ごとのSSIMの変化のグラフを図\ref{fig:graph_ssim}に示す.\\

% 画像
{

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=8cm]{img/graph_error_rate.png}
 \end{center}
 \caption{誤り率の遷移}
 \label{fig:graph_error_rate}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=8cm]{img/img_ssim.png}
 \end{center}
 \caption{画像ごとのSSIMの遷移}
 \label{fig:graph_ssim}
\end{figure}
}

図\ref{fig:graph_error_rate}より，埋め込み率に対する誤り率の遷移が参考文
献\cite{Paper01}の図されたグラフと同様緩やかな２次曲線となった．このこ
とからShalkwijkの数え上げ符号を用いて誤りパターンテーブルを用いた場合の
誤りパターン埋め込み法と同等の機能を実現できたことがわかった．

% 誤り率とSSIMの関係を述べる
% 誤り率とSSIMが両方悪化しており〜みたいなこと

また，図\ref{fig:graph_ssim}よりSSIMが最低でも約0.996とSSIMの基準値であ
る0.98を上回っていることがわかる．これは画質劣化が許容される範囲でLSBだけでなく2bit
列目への埋め込みが可能であることを示しており，また画像ごとに同じ埋め込み
率に対するSSIMが異なることから，画像によっては3bit目4bit目への埋め込みも
可能であるとが考えられる．

\section{おわりに}
本研究では誤りパターン埋め込み法における埋め込み率と画質劣化のトレードオ
フ関係を実験的に明らかにし，これによって画質劣化という観点においてほとん
どの画像でLSB以降への埋め込みが有効であることがわかった．また，Shalkwijk
の数え上げ符号を用いた誤りパターンへの動的な変換方法を提案することで，誤
りパターンテーブルの肥大化問題を解決した．


%-------------------------------------------etitle and eauthors information
\footnotetext[0]{\hspace*{-5.2mm}A study on steganography based on embedding error patterns}
\footnotetext[1]{\hspace*{-6.5mm}\dag Ippei Nawate Hisao Fukuoka}
\footnotetext[2]{\hspace*{-6.5mm}\dag Matsue College Of Technology}

%-------------------------------------------references
\bibliographystyle{junsrt}
\bibliography{draft}

\end{document}
