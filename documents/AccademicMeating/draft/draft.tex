\documentclass[a4j,fleqn,10pt]{jsarticle}
\usepackage{ipsj}
\usepackage{txfonts}
\usepackage[symbol*,perpage]{footmisc}
\usepackage[dvipdfm]{graphicx, color}

%-------------------------------------------jtitle and jauthors information
\begin{document}

\jtitle{誤りパターン埋込み型ステガノグラフィに関する一考察}
\jcontact{松江高専 \dag}
\jauthor{索手イッペイ\dag \and 福岡久雄 \dag}

\maketitle

%-------------------------------------------document
\section{はじめに}{
 ステガノグラフィとは秘密データをメディアデータに埋め込む技術，研究分野
の総称である．一般的な通信では秘密データを暗号化し，それを相手に
送信する．しかし，この方法では秘密データの内容そのものを隠蔽することはで
きるが，通信行為そのものは他者に認知されてしまうため通信妨害をうける可能
性がある．一方ステガノグラフィではメディアデータ内に秘密データを埋め込む
ため，第３者に秘密データの存在を知覚されずに通信を行うことができる．

 ステガノグラフィでは基本的にメディアデータの冗長性を利用して秘密データ
を埋め込みを行う．しかし，埋め込む秘密データの容量が増加するほどにメディ
アデータの質は劣化する．ステガノグラフィではその性質から多くのデータを埋
め込むことが可能であること，そしてそれと同時に埋め込みが主観的・客観的に
認知されないことが求められる．

 本研究ではグレースケール画像にテキスト情報を埋め込むようなステガノグラフィ
技術を対象とし，誤りパターン埋込み法における画質劣化と埋め込み率とのトレー
ドオフ関係を実験的に明らかにする．
}

%-------------------------------------------etitle and eauthors information
\footnotemark[0]
\footnotetext[0]{\hspace*{-5.2mm}A study on steganography based on embedding error patterns}
\footnotetext[1]{\hspace*{-6.5mm}\dag Ippei Nawate Hisao Fukuoka}
\footnotetext[2]{\hspace*{-6.5mm}\dag Matsue College Of Technology}


\section{誤りパターン埋め込み法の概要}{
 ステガノグラフィ技術における代表的な埋め込み方式の一つにLSB法がある．
この手法では秘密データのバイナリ表現をメディアデータのLSB平面とそのまま
置換することによって埋め込みを行う．この手法はアルゴリズムが単純であり
多くの情報をメディアデータに埋め込むことができるほか，LSBのみへ埋め込みを
行うことからメディアデータの品質劣化が少ない．一方でLSBとの置換を無加工
で行うことから埋め込み後のビットの変化が起こりやすいため画質劣化が大きく
なりやすいという問題がある．ここで，埋め込みに使用したビット列長nに対し，
埋め込んだデータ量$n_{embeded}$との割合を埋め込み率，変化したビット数
$n_{inverted}$との割合を誤り率といい，それぞれ以下の式で表される．

 \[
  埋め込み率 = \frac{n_{embeded}}{n}　{,}　誤り率 = \frac{n_{inverted}}{n}
 \]
 
 これまでLSB法の誤り率を改善したいくつか手法が提案されてきた．その
一つとして誤りパターン埋め込み法が知られている．この手法は秘密データをよ
り冗長でハミング重みの小さいビット列である誤りパターンに変換し，誤りパター
ンと画像のLSB平面との排他的論理和でLSB平面を置き換える．こうすることで，
埋め込み後のビットの変化を少なくし，LSB法に比べ優れた誤り率を実現してい
る．しかし，１データの埋め込みにより長いのビット列を必要とすることから埋
め込み率はLSB法に劣ってしまう．
}

\section{誤りパターンの生成}{
 誤りパターンへの変換方法の一つに秘密データ内に出現するビットパターンと誤りパター
ンの対応を表すテーブルを用意する方法が知られている．しかし，秘密データの大きさをm
とすると$2^m$個の要素を対応付けたテーブルが必要となり，テーブルが膨大と
なりやすいことからメモリ制約の大きい環境での実装が困難になるという問題点
があげられる\cite{Paper01}．そこで本研究ではShalkwijkの数え上げ符号
\cite{Paper02}を用いた埋め込みデータから誤りパターンを動的に生成する手法
を提案する．
 Shalkwijkの数え上げ符号とは，長さn，ハミング重みkの２進数の集合に対し${}_n C
_k$種類の２進数を一意に割り当てる符号化方式であり，これを用いて各ビット
パターンに対して誤りパターンとの相互変換を行うことができる．
}

\section{実験方法}\label{sec:experiment}
実験手順の概要を図\ref{fig:experiment_outline1}に示す．以下に示す手順で
実験を行った．実験には256$\times$256pxの8bitグレイスケールBitmapである自然
画像100枚を使用し，埋め込みに使用するメッセージはほぼ当確率で発
生する8bitコードの列とした．

\begin{enumerate}
\renewcommand{\labelenumi}{(\arabic{enumi})}
 \item メッセージの各コードをShalkwijkの数え上げ符号を用いて動的に誤りパターン
       へと変換し，変換した誤りパターンと画像のLSB平面との排他的論理和を
       画像へと埋め込む．
 \item 埋め込み前後の画像を比較し，誤り率，SSIM\cite{Paper03}を算出する．
       %ここで誤り率rは埋め込み前後で変化したビットの数をd，埋め込みに使用した
       % ビットの数をnとして式（\ref{equ:error_rate}）で算出する．
       % \begin{equation}\label{equ:error_rate}
       %   r = \frac{d}{n}\times100
       % \end{equation}
 \item 誤りパターン長を8bitから256bitまで変化させ（１），（２）を繰り返す．
 \item 画像を入れ替えて（３）を繰り返す．
\end{enumerate}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=8cm]{img/experiment1.png}
 \end{center}
 \caption{実験概要1}
 \label{fig:experiment_outline1}
\end{figure}

\section{実験結果}
誤り率に対する埋め込み率と参考文献\cite{Paper01}の式(4)で表される2値エン
トロピー関数H(Δ)の変化のグラフを図\ref{fig:graph_error_rate}に，埋め込み率
による画像ごとのSSIMの変化のグラフを図\ref{fig:graph_ssim}に示す.

% 画像
{

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=8cm]{img/graph_error_rate2.png}
 \end{center}
 \caption{誤り率に対する埋め込み率とH(Δ)変化}
 \label{fig:graph_error_rate}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=8cm]{img/img_ssim.png}
 \end{center}
 \caption{画像ごとのSSIMの変化}
 \label{fig:graph_ssim}
\end{figure}
}

図\ref{fig:graph_error_rate}より，埋め込み率に対する誤り率の遷移が参考文
献\cite{Paper01}の図されたグラフと同様緩やかな曲線となった．このこ
とからShalkwijkの数え上げ符号を用いて誤りパターンテーブルを用いた場合の
誤りパターン埋め込み法と同等の機能を実現できたことがわかった．

% 誤り率とSSIMの関係を述べる
% 誤り率とSSIMが両方悪化しており〜みたいなこと

また，図\ref{fig:graph_ssim}よりSSIMが最低でも約0.996とSSIMの基準値であ
る0.98を上回っていることがわかる．これは画質劣化が許容される範囲でLSBだけでなく2bit
列目への埋め込みが可能であることを示しており，また画像ごとに同じ埋め込み
率に対するSSIMが異なることから，画像によっては3bit目4bit目への埋め込みも
可能であるとが考えられる．

\section{おわりに}
本研究では誤りパターン埋め込み法における埋め込み率と画質劣化のトレードオ
フ関係を実験的に明らかにし，これによって画質劣化という観点においてほとん
どの画像でLSB以降への埋め込みが有効であることがわかった．また，Shalkwijk
の数え上げ符号を用いた誤りパターンへの動的な変換方法を提案することで，誤
りパターンテーブルの肥大化問題を解決した．

%-------------------------------------------references
\bibliographystyle{junsrt}
\bibliography{draft}

\end{document}
