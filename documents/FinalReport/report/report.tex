\documentclass[a4j,fleqn,10pt]{jsarticle}
\usepackage{ipsj}
\usepackage[top=4cm,hmargin=3cm,textheight=24.8cm,textwidth=17cm]{geometry}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage{txfonts}
\usepackage[symbol*,perpage]{footmisc}
\usepackage[dvipdfm]{graphicx, color}
\usepackage{tcpascaltrig}
\usepackage{url}

%------------------------------------------- define sections
% \titlelabel{\thetitle. \quad}
% \renewcommand{\thesection}{\arabic{section}.}
\setcounter{tocdepth}{3}

%-------------------------------------------jtitle and jauthors information
\begin{document}
{\begin{titlepage}
\begin{center}

 \newlength{\titleLineSpace}
 \setlength{\titleLineSpace}{15pt}

 \newlength{\marginBetweenTitle}
 \setlength{\marginBetweenTitle}{10pt}

 \newlength{\marginUnderTitle}
 \setlength{\marginUnderTitle}{45pt}
 
 \newlength{\marginUnderAuthor}
 \setlength{\marginUnderAuthor}{45pt}
 
 \newlength{\marginUnderCollege}
 \setlength{\marginUnderCollege}{55pt}

 \newlength{\marginUnderAbstract}
 \setlength{\marginUnderAbstract}{20pt}
 
 {\LARGE 誤りパターン埋込み型ステガノグラフィに \\
 \vspace{\titleLineSpace} 関する一考察} \\

 \vspace{\marginBetweenTitle}
 
 {\LARGE\bf A study on steganography \\ \vspace{\titleLineSpace} based on embedding error patterns}

 \vspace{\marginUnderTitle}

 {\large 研究者 : 索手　一平 \hspace{80pt} 指導教員 : 福岡　久雄} \\
 {\large Researcher : Ippei NAWATE \hspace{40pt} Supervisor : Hisao FUKUOKA}

 \vspace{\marginUnderAuthor} 

 {\large 松江工業高等専門学校情報工学科} \\
 {\large Department of Information Engineering, Matsue College of
 Technology}

 \vspace{\marginUnderCollege}

 {\large\bf Abstract} \\

 \vspace{-11pt}
 
 \begin{flushleft}
  \begin{spacing}{1.3}
   {\fontsize{11}{12}\selectfont 本論文は，テキスト情報をグレースケール画像に埋め込むステガ
   ノグラフィ技術を対象とする．データの埋め込み手 法の一つである誤りパター
   ン埋め込み法は，テキスト情報を冗長かつハミング重みの小さいビット列（こ
   れを誤りパターンという）に変換し，画像中のLSB平面との排他的論理和でLSB
   平面を置き換える．本研究では，誤りパターン埋め込み法における画質劣化等に
   ついて考察する．また，Shalkwijkの数え上げ符号を用いた誤りパターンの動的
   生成方法を提案する．}
  \end{spacing}
 \end{flushleft}
 
 \vspace{\marginUnderAbstract}
 
 {\large\bf Keywords} \\
 {\normalsize ステガノグラフィ，セキュリティ，誤りパターン}

\end{center} 
\end{titlepage}}

\newgeometry{top=3cm,hmargin=2.3cm,textheight=24.8cm,textwidth=17cm}


\tableofcontents
\thispagestyle{empty}
\newpage


\setcounter{page}{1}
\newgeometry{top=3cm,bottom=3cm,hmargin=2.3cm,textheight=24.8cm,textwidth=17cm,twocolumn=true}

\section{はじめに}{
近年，ネットワーク通信の増加に伴い，安全に通信を行うための技術の重要性が
高まってきている．特に秘密情報の通信において重要なものとなる．
安全に通信を行う手段として主なものに送信内容の暗号化がある．暗号
化により，送信内容を第三者に読み取られない状態とすることで，第三者による
盗聴，なりすましといった妨害行為を防ぐことができる．しかし，通信行為その
ものは第三者に認知されていることから，通信経路の遮断などといった妨害行為を
うける可能性を排除できない．この点に対し，ステガノグラフィでは送信内容を
別のデータに埋込むことで，第三者から秘密情報の存在そのものを隠蔽する．
つまり，通信行為そのものを隠蔽し，より安全な通信を実現することができる．

本論文ではステガノグラフィ技術の中で最も埋め込みに利用される画像，特にグレイスケー
ル画像に対し，埋め込みデータをテキスト情報とし，誤りパターン埋め込み法に
おける埋め込み率と誤り率，画質劣化とのトレードオフ関係を実験的に明らかに
する．なお，画質劣化の指標にはSSIM\cite{Paper03}を用いる．また，誤りパター
ンテーブル法の肥大化問題\cite{Paper01}に対する解決策としてShalkwijkの数え上げ符号
\cite{Paper02}を用いた誤りパターンの動的生成手法を提案する．
}

\section{ステガノグラフィとは}{
ステガノグラフィとは秘密情報を別の媒体に埋め込む技術，研究の総称であり，
情報ハイディング技術の一つである．

% ステガノグラフィでは一般的に，埋め込み対象となる画像をカバーデータ，埋め込
% みによって生成されたデータをステゴデータと呼ぶ．

% ステガノグラフィを用いた通信は図\ref{fig:stego_com}に示すように，送信者
% が秘密情報をデジタルデータ内に埋込み，受信者が送信されたデジタルデータか
% ら秘密情報を取り出すことで行われる．

% このとき，送信されたステゴデータが自
% 然なものであれば，第三者は送信内容を確認できたとしても秘密情報の存在を検
% 知できない．

% \begin{figure}[htbp]
%  \begin{center}
%   \includegraphics[width=7.5cm]{img/stego_com_model.png}
%  \end{center}
%  \caption{ステガノグラフィの通信モデル}
%  \label{fig:stego_com}
% \end{figure}

ステガノグラフィ以外の情報ハイディング技術として電子透かしがあるが，これ
はデータの著作権や所有権を保護するために，そのデータの中
に，ある証拠データを埋め込む技術のことである．電子透かしでは埋め込まれる
証拠データの頑健さ，つまり他者に除去されないことが重要である．一般的に埋
め込まれる情報は少量であり，外部に見えることが望ましいため証拠データその
ものには大きな価値はない．

一方でステガノグラフィは秘密情報を隠蔽するために，秘密情報を別のデータ
（これをカバーデータという）内に埋め込む．ステガノグラフィでは電子透かし
とは逆に埋め込まれる秘密情報そのものに大きな価値があり，カバーデータに価
値はない．また隠蔽性の高さ，つまり他者に秘密情報が埋め込まれているという
事実そのものを検知されないことが重要となる．一般的に埋め込まれる情報は少
量とは限らず，多くのデータの埋め込みは埋め込み対象となる別のデータを劣化
させてしまうため，ステガノグラフィでは以下の2点を同時に満たすことが強く
望まれる．

% ステガノグラフィでは，「別の媒体に埋め込む」という特性から，カバーデータ
% によっては多くの情報を埋め込むことが困難となる．また，一般的に多くの情報
% を埋め込むほどにステゴデータはカバーデータと比べ劣化し，劣化が大きければ
% 第三者から秘密情報の存在を認知される可能性が高まるためステガノグラフィは
% 意味を成さなくなる．このような特性からステガノグラフィでは以下の２点を同
% 時に満たすことが強く望まれる．

\begin{enumerate}
 \item できるだけ多くの情報の埋め込みが可能である
 \item 埋め込みが主観的・客観的に認知されない
\end{enumerate}

また，秘密情報を埋め込まれたカバーデータをステゴデータと呼ぶ．

カバーデータには主に音楽，画像などのメディアデータが用いられる．ほとんどのメディア
データはいくらかの冗長性を有しており，これらを利用した埋め込みが主流であ
る．本論文で取り上げる画像では，画像中の各ピクセルにおけるLSBなどの下位
ビットが冗長性ということになる．
これらのビットはそれぞれが持つ情報量が少なく，変化させたとしても視覚的変
化がほとんど発生しない．特にLSBは情報量が最も少ないことから，埋め込み利
用されることが多い．実際，この特性を利用した埋め込み手法としてLSB法（章
\ref{sec:lsb_tecknique}）が提案されており，ステガノグラフィにおける最も
一般的な埋込み手法として知られている．

\section{LSB法\label{sec:lsb_tecknique}}
LSB法とは画像の各ピクセルにおけるLSBのみを埋め込み対象とすることで，埋
め込みによる画像の劣化を抑えた手法である．この手法は，図
\ref{fig:lsb_emb}に示すように，カバーデータ中のLSBに対しテキスト情報のバ
イナリ表現をそのまま置き換えることで埋め込みを行なう．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/lsb_emb.png}
 \end{center}
 \caption{LSB法での埋め込み}
 \label{fig:lsb_emb}
\end{figure}

また，埋め込み時にLSBをテキスト情報のバイナリ表現でそのまま置換すること
から，図\ref{fig:lsb_ext}のようにステゴデータのLSBのからテキスト情報を直
接抽出することができる．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/lsb_ext.png}
 \end{center}
 \caption{LSB法での抽出}
 \label{fig:lsb_ext}
\end{figure}

単純なアルゴリズムであり実装が容易である反面，埋め込み後のビット誤り
が起きやすく，図\ref{fig:lsb_emb}のようにすべてのビットが反転してしまう
場合もある．このため，ステゴデータの画質が劣化しやすく，ステゴデータの隠
蔽性に問題を引き起こす可能性がある．

このような問題から，これまでLSB法におけるビット誤りを改善した手法が多数
提案されてきた．それらの中でも本論文で扱う誤りパターン埋め込み法は，ビット
誤りを大きく改善した手法として知られている．これについて事象で述べる．

本論文ではカバーデータのうち，埋め込みに対象となるビット列をカバービット
列，ステゴデータ中のデータが埋め込まれたビット列をステゴビット列と呼ぶ．
また，カバービット列とテキスト情報のバイナリ表現のビット長をそれぞれ
$n$，$m$，ステゴビット列中の誤りビットの数を$d$として，$\frac{m}{n}$を埋
め込み率，$\frac{d}{n}$を誤り率とする．

埋め込み率，誤り率は埋め込み評価指標として利用される．埋め込み率はいかに
効率よくテキスト情報を埋め込めているかを表しており，高いほどに多くの情報
を埋め込むことができる．また，誤り率は埋め込みによるビット誤りの発生頻度
を表しており，一般的に誤り率が高いほど画質が劣化する傾向にある．LSB法で
は埋め込み率は常に100％であるが，一方でビット誤りが起きやすいことから誤
り率が高い．
}

\section{誤りパターン埋め込み法\label{sec:way_error_pattern}} {
LSB法をもとに，より低い誤り率での埋め込みを実現した手法として誤りパター
ン埋め込み法が知られている．この手法では次章にて述べる変換方式を用いてテ
キスト情報のバイナリ表現を，より長くハミ
ング重みの小さいビット列である誤りパターンに変換する．そして，カバービッ
ト列をそのまま置き換えるのではなく，カバービット列と誤りパターンとの排他
的論理和でカバービット列を置き換える（図\ref{fig:error_pt_emb}）．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/error_pt_emb.png}
 \end{center}
 \caption{誤りパターン埋め込み法での埋め込み}
 \label{fig:error_pt_emb}
\end{figure}

また，カバービット列とステゴビット列との排他的論理和をとることで誤りパター
ンを抽出することができ，その誤りパターンをテキスト情報へと逆変換することで
テキスト情報の抽出を完了する（図\ref{fig:error_pt_ext}）．


\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/error_pt_ext.png}
 \end{center}
 \caption{誤りパターン埋め込み法での抽出}
 \label{fig:error_pt_ext}
\end{figure}

埋め込みに排他的論理和を用いることから，誤りパターンにおける「１」の対応
するビットのみがカバービット列中で置き換わるため，ビット誤りを大幅に抑え
ることができる．一方でより長いビット列を使用することから結果としてに埋め込み
率は減少する．

この手法ではステゴビット列中で発生するビット誤りは誤りパターンのハ
ミング重みと同じであり，生成される誤りパターンは埋め込まれるテキスト情報
によることから，誤り率はテキスト情報の内容に依存する．そのため同じテキス
ト情報を埋め込みデータとした場合，カバーデータによらず誤り率は等しい．ま
た，テキスト情報の抽出時にカバービット列とステゴビット列の比較を用いるこ
とから，この手法は埋め込みデータの抽出にカバーデータを必要とする手法であ
る．
}

\section{誤りパターンの生成方法\label{sec:create_error_pt}} {

一般的な誤りパターンの生成方法として各文字のバイナリ表現と誤りパターンとの対応を示した
誤りパターンテーブルを利用した方法がある．誤りパターンテーブルの例を表
\ref{tab:error_pt_table}に示す．この方法では埋め込み時，抽出時にテーブル
を参照することで相互の変換を行う．単純な方式であり実装が容易である一方で，
テキスト情報の各文字のバイナリ表現を$m$ビットとしたとき，最大で$2^m$個の誤りパ
ターンを対応付ける必要があることから，テーブルが膨大となりやすく，強い
メモリ制約下での実装が困難であるという問題点がある．

\begin{table}[h]
 \centering
 \caption{誤りパターンテーブル}
 \label{tab:error_pt_table}
 \begin{tabular}{|c|c|} \hline
  埋め込みデータ & 誤りパターン \\ \hline
  000 & 0000000 \\ \hline
  001 & 0000001 \\ \hline
  010 & 0000010 \\ \hline
  011 & 0000100 \\ \hline
  100 & 0001000 \\ \hline
  101 & 0010000 \\ \hline
  110 & 0100000 \\ \hline
  111 & 1000000 \\ \hline
 \end{tabular}
\end{table}

この問題の解決策として文献\cite{Paper01}では，コスト付き符号化を用いた誤
りパターンテーブルの効率的実装方法が提案されている．

本論文では誤りパターンテーブルを用いない生成方法として，Shalkwijkの数え上げ
符号\cite{Paper02}を用いた誤りパターンの動的生成手法を提案する．


\subsection{Slalkwijkの数え上げ符号\label{sec:shalkwijk}}
Shalkwijkの数え上げ符号とは長さ$n$，ハミング重み$k$の２進数列xの
集合に対し10進数$i(x)$を一意に割り当てることができる符号化手法である．な
おi(x)は
\begin{center}
 \[
 0 \leq i(x) \leq {}_n C_k
 \]
\end{center}
を満足する．

\begin{figure}
 \pascaltrig{7}
 \caption{パスカルの三角形}
 \label{fig:pascale}
\end{figure}

またパスカルの三角形を用いて$x$，$i(x)$間の相互変換が可能である．この方
法ではパスカルの三角形における$n+1$段目，左から$k+1$番目の値を起点として変換を行う．
一例として$x= 010100$としたときの符号化について考える．この$x$は
$n = 6$，$k = 2$であるからまず頂点の$1$から数えて$7$段目，左から$3$番目
の値である$15$に注目する．ここで$x$のMSBから$1$ビットずつ値を取り出して
いき，
$0$であれば右斜め上に，$1$ならば左斜め上の値に注目点を移動する．また取り出した値が
$1$であったとき注目点を移動する前の値から見て右斜め上の値を記憶し加算し
ていく．今回の場合，MSBが$0$であるから右斜め上の$10$に移動する．そして次のビットは
$1$であるから右斜め上の$6$を記憶し，左斜め上の$4$に移動する．これを繰り
返し，頂点に達した時点で終了となる．$x = 010100$とした場合，最終的に加算
していった値として$8$が得られ，これが$x$に割り当てられる$i(x)$となる．


次に$i(x)$から$x$への復号化について考える．
復号化では注目点から見て右斜め上の値と$i(x)$とを比較し，MSBから順に各ビッ
トの値が決定される．比較対象となる値を$n$として$ i(x) < n$であればビッ
トは$0$として注目点を右斜め上の値移動する．$ i(x) \geq n$であればビット
は$1$として左斜め上の値に移動し，$i(x) = i(x) - n$としてi(x)の値を減らし
ていく．今回の場合，起点である$15$から見て右斜め上
の値は$10$であり，これよりも$8$は小さいことからMSBは$0$であることが決ま
り，そのまま右斜め上の$10$に移動する．次に，$10$の位置から見ると右斜め上の値は
$6$であり$8$のほうが大きいことから左斜め上の$4$に移動し，
次のビットは$1$とする．このとき，値$8$から$6$を引いた値である$2$を記憶す
る．これを繰り返していくことによって最終的に$010100$が得られる．
これが$n = 6, k = 2$とした場合に$8$に対応する$x$ということになる．最終的
に$n =6, k = 2$の2進数列$x$の集合は10進数$i(x)$が表\ref{tab:shalkwijk}の
ように割り当てられる．

\begin{table}[h]
 \centering
 \caption{$n = 6, k = 2$の場合の対応付け}
 \label{tab:shalkwijk}
 \begin{tabular}{|c|c|c|c|} \hline
  $x$    & $i(x)$ & $x$    & $i(x)$ \\ \hline
  000011 & 0      & 010100 & 8      \\ \hline
  000101 & 1      & 011000 & 9      \\ \hline
  000110 & 2      & 100001 & 10     \\ \hline
  001001 & 3      & 100010 & 11     \\ \hline
  001010 & 4      & 100100 & 12     \\ \hline
  001100 & 5      & 101000 & 13     \\ \hline
  010001 & 6      & 110000 & 14     \\ \hline
  010010 & 7      &        &        \\ \hline
 \end{tabular}
\end{table}

\subsection{誤りパターンの動的生成\label{sec:dynamic_error_pt}}
動的生成のアルゴリズム中ではテキスト情報の各文字のバイナリ表現を2進数列
$x$として与えることで，パスカルの三角形を用いて10進数$i(x)$へと変換する．
このとき，$x$が一意のであるの一方で，異なる$x$に対し同じ$i(x)$が割り振ら
れる場合がある．例えば，表\ref{tab:shalkwijk}で$x = 000011$に割り当てら
れる$i(x)$は$0$であるが，$x = 000000$に対しても同様に$0$が割り当てられる．
そこで$x$の長さ$n$，ハミング重み$k$を元に式(\ref{eq:offset})で求め
られるoffset$_k$をi(x)に加算することで一意の誤りパターンとする．

\begin{equation}  % displaymath,eqnarray いずれも可能
 \begin{array}{l}
  \mbox{offset}_k = {\displaystyle \sum_{i=0}^{k-1}} {_n C_i} \\
  \mbox{offset}_0 = 0 
 \end{array}
 \label{eq:offset}
\end{equation}

この方法を用いることで誤りパターンを動的に生成し，強いメモリ制約下での誤
りパターン変換をを可能にすることができる．
}

%------- やったこと（ステガノグラフィ）
%
% ・PSNR，誤り率，SSIMの計算
% ・画像事のSSIMの計算
% ・LSB以降への埋め込み
% ・LSBのみの場合とLSB＋２ビットの場合にそれぞれ同じ文字数で埋込み
% ・理論的下限曲線との比較


%------- やったこと（SSIM）
%
% ・分割からの面積計算
% ・ビット周りの分散

\section{実験}
\subsection{実験手順}
実験手順の概要を図\ref{fig:experiment1}に示す．以下に示す手順で実験を行った．実
験には256$\times$256pxの8ビットグレイスケールBitmapであるSIDBA画像30枚を
使用し，埋め込みに使用するテキスト情報は当確率で発生する8bitコードの列と
した．テキスト情報の生成には623次元に分布する乱数発生器であるSFMTを用いた．

\begin{enumerate}
\renewcommand{\labelenumi}{(\arabic{enumi})}
 \item テキスト情報の各コードを章\ref{sec:dynamic_error_pt}にて述べた手
       法で動的に誤りパターンへと変換し，変換した誤りパターンと画像のLSB
       平面との排他的論理和を画像へと埋め込む．\label{enum:experiment1-1}
 \item 埋め込み前後の画像を比較し，誤り率，SSIMを算出する．\label{enum:experiment1-2}
 \item 誤りパターン長を8bitから256bitまで変化させ（\ref{enum:experiment1-1}），（\ref{enum:experiment1-2}）を繰り返す．\label{enum:experiment1-3}
 \item 画像を入れ替えて（\ref{enum:experiment1-3}）を繰り返す．
\end{enumerate}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/experiment01.png}
 \end{center}
 \caption{実験概要}
 \label{fig:experiment1}
\end{figure}

\subsection{実験結果}
\subsubsection{誤り率と埋め込み率}
誤り率の計測結果と文献\cite{Paper01}において示されている誤りパターン埋め
込み法における誤り率の理論的下限曲線を図\ref{fig:graph_error_rate}に示す．
なお，誤りパターン埋め込み法における誤り率は埋め込まれるテキスト情報にの
み依存するため，同じテキスト情報が埋め込まれたすべての画像について計測さ
れる誤り率は等しい．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_error.png}
 \end{center}
 \caption{埋込率に対する誤り率の変化}
 \label{fig:graph_error_rate}
\end{figure}

 図\ref{fig:graph_error_rate}より，実際に計測した誤り率は理論的下限曲線
と同様，埋め込み率が増加するとともに誤り率も増加し，理論的下限曲線に比べ
曲率の低い曲線を描いた．

\subsubsection{SSIMと誤り率\label{sec:result_ssim1}}
30枚のSIDBA画像のうち，SSIMの最も高い画像10枚と最も低い10枚の埋込率に対
するSSIMの変化を図3に示す．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_ssim_lsb_only.png}
 \end{center}
 \caption{埋込率に対するSSIMの変化（画像ごと）}
 \label{fig:graph_ssim1}
\end{figure}

図\ref{fig:graph_ssim1}よりすべての埋め込み率についてSSIMが0.99を上回って
いることがわかる．一般的にSSIMは0.98以上で比較された画像間の見分けがつか
ないと言われていることから，どのような埋め込み率に対しても画質が大きく劣
化することはないと考えられる．このことから，埋め込みをLSB平面に限定した
場合，埋め込み率，誤り率によって画質が大きく劣化することはなく，画質劣化
の面でステガノグラフィ技術の隠蔽性に大きく影響を与えることはないというこ
とがわかる．同時に図\ref{fig:graph_ssim1}より，画像ごとにSSIMの変化の様
子が異なることがわかる．これについて，実験に使用した画像を主観的に観察し
たところ，図\ref{fig:best_ssim_image}のように画像全体の複雑度が高い画像
ほどSSIMの変化が小さく，一方で図\ref{fig:least_ssim_image}のように複
雑度の低い大きな領域を含む画像ほどSSIMの変化が大きくなるという傾向が見ら
れた．ここで複雑度とは画像全体における画素間の明暗の変化の多さを表してお
り，複雑度が高いほどにノイズ画像のようになる．これは，埋め込まれるデータ
内の0,1の発生はランダムであり，埋め込みによる画像の劣化がノイズ状に発生
することから，図\ref{fig:best_ssim_image}のように複雑度が高い画像であれ
ば画像中にノイズが溶け込んみ，目立たなくなってしまうためであると考えられる．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/BRIDGE.png}
 \end{center}
 \caption{BRIDGE.bmp}
 \label{fig:best_ssim_image}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/Balloon.png}
 \end{center}
 \caption{Balloon.bmp}
 \label{fig:least_ssim_image}
\end{figure}

\subsubsection{2ビットプレーン以降の埋め込みでの実験結果\label{sec:more_bit_prane}}
章\ref{sec:result_ssim1}の結果から，隠蔽性に影響を及ぼさない範囲で2ビットプレーン以降への埋め込みも可能なのではないかと考え，2〜4ビットプレーンまでの埋め込みを行った．実験手順はこれまでと
同様の手順で行い，実験対象となるビットプレーン以下のビットプレーンについ
ては埋め込み率100％で埋め込みを行った．実験結果をそれぞれ図
\ref{fig:graph_ssim2}〜\ref{fig:graph_ssim4}に示す．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_ssim_second_plane.png}
 \end{center}
 \caption{埋込率に対するSSIMの変化（2ビットプレーン使用）}
 \label{fig:graph_ssim2}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_ssim_third_plain.png}
 \end{center}
 \caption{埋込率に対するSSIMの変化（3ビットプレーン使用）}
 \label{fig:graph_ssim3}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_ssim_fouth_plain.png}
 \end{center}
 \caption{埋込率に対するSSIMの変化（4ビットプレーン使用）}
 \label{fig:graph_ssim4}
\end{figure}

図\ref{fig:graph_ssim2}より埋め込み率$0.9$前後でSSIMが$0.98$を下回り始め
ていることがわかる．このことから，LSBへの埋め込みを100％として2ビットプ
レーンまで埋め込みを行うことで，ほとんどの画像に対し，隠蔽性に影響を及ぼさない範囲で，約1.9倍のテキスト情報の埋め込
みが実現できるといえる．

図\ref{fig:graph_ssim3}より３ビットプレーンまで埋め込み率100％での埋め込
みを行ったとしてもSSIMが0.98を上回る画像があることがわかる．また，図
\ref{fig:graph_ssim4}においても最大で埋め込み率0.2前後までテキスト情報を
埋め込むことができることがわかる．

ここで，図\ref{fig:best_ssim_image}，\ref{fig:least_ssim_image}のステゴ
データをそれぞれ図\ref{fig:best_ssim_image_emb}，
\ref{fig:least_ssim_image_emb}に示す．ステゴデータはLSBから3ビットプレーンま
で埋め込み率100％で埋め込みを行ったものである．図
\ref{fig:least_ssim_image_emb}はもとの画像に比べ視覚的に大きく劣化が生じ
ており，一方図\ref{fig:best_ssim_image_emb}は劣化が小さく元の画像からほ
とんど変化していない．これらのことから適切な画像を選択することでよりLSB
のみへの埋め込みに比べ3倍以上のテキスト情報の埋め込みが可能になるといえ
る．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/8_7_BRIDGE.png}
 \end{center}
 \caption{BRIDGE.bmpのステゴデータ}
 \label{fig:best_ssim_image_emb}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/8_7_Balloon.png}
 \end{center}
 \caption{Balloon.bmpのステゴデータ}
 \label{fig:least_ssim_image_emb}
\end{figure}

\subsubsection{メッセージ長が同じ場合の劣化について}
埋め込み範囲を広げて同じメッセージ量を埋め込む場合，より長い誤りパターン
を用いることができることから，ステゴデータの誤り率を下げることができる．

例えば，LSBのみへ埋め込み率100％，つまり誤りパターン長を8ビットとして埋
め込みを行った場合，256$\times$256pxの画像であれば8192文字の埋め込みが可
能である．これを2ビットプレーンにまで埋め込み範囲を拡張して埋め込みを行っ
た場合，単純に埋め込み範囲が倍になることから誤りパターン長を2倍の16ビッ
トとして埋め込みを行うことができ，誤り率を半減させることができる．

これについて，LSBのみへ埋め込みを行った場合，2ビットプレーンまで埋め込ん
だ場合について，どのような違いが見られるかを検証するため，今までと同様の
実験手順で比較を行った．

30枚のSIDBA画像のうちBRIDGE.bmp（図\ref{fig:best_ssim_image}）を使用した場合の実験結果を図
\ref{fig:graph_vs_same_message_length}に示す．この結果から埋め込む文字数
にかかわらず，2ビットプレーンまで埋め込みを行った場合のSSIMがLSBのみの場
合を下回っていることがわかる．このことから埋め込み範囲を拡張することによっ
て画質劣化を抑えることはできないといえる．

% しかし，この図においてSSIMは
% 0.98を上回っており，視覚的な隠蔽性に問題がないことから，誤りによる埋め込
% みの検出を回避する目的に利用するという面では有用であるといえる．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_same_message_length.png}
 \end{center}
 \caption{埋込率に対する誤り率の変化}
 \label{fig:graph_vs_same_message_length}
\end{figure}

% \section{SSIMに対する画像特性に関する実験\label{sec:consider_ssim}}

% 章\ref{sec:result_ssim1}にて，画像によってSSIMの変化が大きくことなること
% を示した．これについて実験者の主観で画像評価を行ったところ，複雑度の高い
% 画像ほどSSIMが下がりにくくなる傾向にあるということがわかった．ここで複雑
% 度とは画像全体における画素間の明暗の変化の多さを表しており，複雑度が高いほどにノイズ画
% 像のようになる．これを客観的に評価するため，２つの評価方法を考案し実験を
% 行った．これらの実験では画像を母集団とみなし，それらがが正規分布であると
% するために，第\ref{sec:result_ssim1}の実験で使用した30枚のSIDBA画像に加え，同サイズ
% の8ビットグレースケールビットマップ70枚をWeb上で収集し使用した．章
% \ref{sec:result_ssim1}においてSSIMが最も高かった画像，最も低かった画像の
% 埋め込み前後の画像を図


% \subsection{画素周辺との分散値による実験\label{sec:despertion_vs_ssim}}
% 画像を図\ref{fig:graph_ssim3}のように少区間に分割し，その少区間中での画
% 素値の分散値の平均を求めることで，画像の複雑度を判別できると考え以下の手
% 順で実験を行った．

% \begin{figure}[htbp]
%  \begin{center}
%   \includegraphics[width=7.5cm]{img/lsb_emb.png}
%  \end{center}
%  \caption{埋込率に対する誤り率の変化}
% \end{figure}

% \begin{enumerate}
%  \item 各画像の少区間ごとの画素値の分散を計算し，それらの平均を求める．\label{enu:split1}
%  \item 少区間のサイズを変え，再度(\ref{enum:split1})を繰り返す．\label{enu:split2}
%  \item 画像を入れ替えて(\ref{enu:split2})を繰り返す．
% \end{enumerate}

% この実験では256$\times$256pxの画像を使用したことから，少区間のサイズは画
% 素の漏れや重複なく計算が行えるよう一辺が画素数2,4,8,16,32,64個分である正
% 方形とした．
% 少区間ごとの画素値の分散の平均値と埋め込み率100％でLSBに埋め込みを行った
% 場合のSSIMとの相関を表\ref{tab:despertion_vs_ssim}に示す．この結果から少
% 区間を細かく設定することでSSIMとの高い相関が得られていることがわかる．こ
% のことからは予想通りSSIMと小区間での画素値の変化が高いこと，つまり複雑度の高い画
% 像ほどSSIMが高く保たれる傾向にあるといえる．

% \begin{table}[h]
%  \centering
%  \caption{誤りパターンテーブル}
%  \label{tab:despertion_vs_ssim}
%  \begin{tabular}{|c|c|} \hline
%   少区間の一辺の画素数 & 相関 \\ \hline
%   2  & 0.721631188            \\ \hline
%   4  & 0.717703982            \\ \hline
%   8  & 0.65476536             \\ \hline
%   16 & 0.569234861            \\ \hline
%   32 & 0.466591644            \\ \hline
%   64 & 0.337251306            \\ \hline
%  \end{tabular}
% \end{table}

% \subsection{画素区切りと面積\label{sec:image_area_exp}}
% 画素値を0〜5，6〜10というように細かい区間で区切り，その区間内の画素値を
% 持つ画素のみを画像から抽出する（以下抽出画像とする）．抽出された画素によって構成される面積を計算
% することで，画像の複雑度を判別できると考え以下の実験を行った．また，本実
% 験は章\ref{sec:despertion_vs_ssim}と同様の画像100枚を用いて実験を行った．

% \begin{enumerate}
%  \item 画像から画素値区間ごとの画素のみを抽出し，抽出画像を生成する
%  \item 抽出画像を区間内の画素とそれ以外の画素とで2値化する
%  \item 生成された画像それぞれに対しラベリング処理を行い，抽出画像ごとの最大面積を計算
%        する
%  \item 抽出画像ごとの最大面積の中で最大の面積を求める
%  \item 画像を入れ替えて(1)〜(4)を繰り返す
%  \item 画素値区間の分割数を変更し，(5)を繰り返す．
% \end{enumerate}

% 画素は10，20，30個の区間に分割し，それぞれ計測を行った．計測された最大面
% 積と埋め込み率100％でLSBに埋め込みを行った場合のSSIMとの相関を表
% \ref{tab:areasize_vs_ssim}に示す．この結果から画素値区間の分割数をを20ま
% たは30とすることで高い相関が得られていることがわかる．このことから近しい
% 画素値によって構成される大きな領域を含む画像ほどSSIMが減少しやすいといえ
% る．

% \begin{table}[h]
%  \centering
%  \caption{誤りパターンテーブル}
%  \label{tab:despertion_vs_ssim}
%  \begin{tabular}{|c|c|} \hline
%   分割数 & 相関 \\ \hline
%   10  & 0.721631188 \\ \hline
%   20 & 0.717703982  \\ \hline
%   30  & 0.65476536  \\ \hline
%  \end{tabular}
% \end{table}

\section{実験環境}
\begin{itemize}
 \item OS : Mac OS X 8，9，Windows 7，Ubuntu 13.10
 \item IDE : Intellij IDEA 13.0
\end{itemize}

\section{画像の入手元}
\begin{enumerate}
 \item 神奈川大学 \\
       \url{http://www.ess.ic.kanagawa-it.ac.jp/app_images_j.html}
 \item 京都大学 \\
       \url{http://vision.kuee.kyoto-u.ac.jp/IUE/IMAGE_DATABASE/STD_IMAGES/index.html}
 \item Ashi-LAB \\
       \url{http://asssy.sakura.ne.jp/idba.html}
 \item Rensselaer Polytechnic Institute
       \url{http://www.cipr.rpi.edu/resource/stills/index.html}
\end{enumerate}

\section{おわりに}
 本研究では誤りパターン埋め込み法における埋め込み率と誤り率，画質劣化と
のトレードオフ関係を実験的に明らかにした．これによって，埋め込みをLSB平面に
限定した場合，埋め込み率，誤り率によって画質が大きく劣化することはなく，ステガノグラ
フィ技術の隠蔽性に大きく影響を与えることはないということがわかった．さら
に，この結果から埋め込み範囲を広げてのSSIMの計測を行い，2ビットプレーン
を使用することでほとんどの画像に対し1.9倍近くのテキスト情報の埋め込みが
可能であること，画像を適切に選択することで3倍以上ものテキスト情報の埋め
込みが可能であることを示した．

 また，Shalkwijkの数え上げ符号を用いた誤りパターンへの動的な変換方法を提
案することで，強いメモリ制約下における誤りパターンテーブルの実装問題に対
する解決策を示した．しかし，本実験で使用した環境は決してメモリ制約の強い
環境ではないため，今後実際に強いメモリ制約下での実験を行う必要がある．

%-------------------------------------------header and footer

%-------------------------------------------document

%-------------------------------------------references
\bibliographystyle{junsrt}
\bibliography{report}

\end{document}