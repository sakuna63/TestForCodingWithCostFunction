\documentclass[a4j,10pt]{jsarticle}
\usepackage{amsmath}
\usepackage{ipsj}
\usepackage[top=4cm,hmargin=3cm,textheight=24.8cm,textwidth=17cm]{geometry}
\usepackage{txfonts}
\usepackage[symbol*,perpage]{footmisc}
\usepackage[dvipdfm]{graphicx, color}
\usepackage{tcpascaltrig}
\usepackage{url}
\usepackage{nidanfloat}

% \usepackage[hang, center]{caption}
% \captionsetup[table]{labelsep=space}
% \captionsetup[figure]{labelsep=space}

%------------------------------------------- define sections
% \titlelabel{\thetitle. \quad}
% \renewcommand{\thesection}{\arabic{section}.}
\setcounter{tocdepth}{3}

\newlength{\figureWidth}
\setlength{\figureWidth}{16cm}
%-------------------------------------------jtitle and jauthors information
\begin{document}
{\begin{titlepage}
\begin{center}

 \newlength{\titleLineSpace}
 \setlength{\titleLineSpace}{15pt}

 \newlength{\marginBetweenTitle}
 \setlength{\marginBetweenTitle}{10pt}

 \newlength{\marginUnderTitle}
 \setlength{\marginUnderTitle}{35pt}
 
 \newlength{\marginUnderAuthor}
 \setlength{\marginUnderAuthor}{35pt}
 
 \newlength{\marginUnderCollege}
 \setlength{\marginUnderCollege}{45pt}

 \newlength{\marginUnderAbstract}
 \setlength{\marginUnderAbstract}{20pt}
 
 {\LARGE 誤りパターン埋め込み型ステガノグラフィに \\
 \vspace{\titleLineSpace} 関する一考察} \\

 \vspace{\marginBetweenTitle}
 
 {\LARGE\bf A study on steganography \\ \vspace{\titleLineSpace} based on embedding error patterns}

 \vspace{\marginUnderTitle}

 {\large 研究者 : 索手　一平 \hspace{80pt} 指導教員 : 福岡　久雄} \\
 {\large Researcher : Ippei NAWATE \hspace{40pt} Supervisor : Hisao FUKUOKA}

 \vspace{\marginUnderAuthor} 

 {\large 松江工業高等専門学校情報工学科} \\
 {\large Department of Information Engineering, Matsue College of
 Technology}

 \vspace{\marginUnderCollege}

 {\large\bf 概要} \\

 \vspace{-5pt}

 \begin{flushleft}
  {\small
  本論文は，テキスト情報をグレースケール画像に埋め込むステガ
  ノグラフィ技術を対象とする．ステガノグラフィ法の一つである誤りパター
  ン埋め込み法は，テキスト情報を冗長かつハミング重みの小さい誤りパター
  ンというビット列に変換し，画像中のLSB平面との排他的論理和でLSB
  平面を置き換える．本研究では，誤りパターン埋め込み法における画質劣化等に
  ついて考察し，2ビット〜4ビット列目を使用することでLSBのみを埋め込みに使用
  した場合の1.9〜3.0倍のテキスト情報を第三者から埋め込みが主観的に検知さ
  れない範囲で埋め込み可能であることを示す．また，Shalkwijkの数え上げ符
  号を用いた誤りパターンの動的生成方法を提案する．
  }
 \end{flushleft}

 \vspace{10pt}
 
 {\large\bf Abstract} \\

 \vspace{-5pt}
 
 \begin{flushleft}
  {\small
  This paper studies a steganography techniques to embed text
  information into gray scale images. The method of embedding error
  patterns is one of the steganography methods. In embedding process,
  each character in text information is converted into an error pattern,
  a binary string longer in length and lighter in Hamming weight than
  the binary data of the character, then the LSB plane of the image is
  exclusive-ORed with the error pattern. We have evaluated the image quality
  degradation by embedding error patterns and have shown
  that using the second to fourth LSB planes for embedding enables us to embed 1.9 to
  3.0 times more text information with almost perfect imperceptibility for image
  degradation. This paper also proposes a method of dynamically
  generating error patterns using the enumerative code proposed by
  Shalkwijk.
  }
 \end{flushleft}

 
 \vspace{\marginUnderAbstract}
 
 {\large\bf キーワード} \\
 {\normalsize ステガノグラフィ，セキュリティ，誤りパターン，数え上げ符号}

\end{center} 
\end{titlepage}}

\newgeometry{top=3cm,hmargin=2.3cm,textheight=24.8cm,textwidth=17cm}

\tableofcontents
\thispagestyle{empty}
\newpage

\setcounter{page}{1}
\newgeometry{top=3cm,bottom=3cm,hmargin=2.3cm,textheight=24.8cm,textwidth=17cm,twocolumn=true}

\section{はじめに}{
近年，ネットワーク通信の増加に伴い，安全に通信を行うための技術の重要性が
高まってきている．安全に通信を行う手段として送信内容の暗号化が挙げられる．
暗号化を施すことで，第三者による盗聴，なりすましといった妨害行為を防ぐこ
とができるが，通信行為そのものは第三者に認知されてしまうことから，通信経
路の遮断などといった妨害行為をうける可能性を排除できない．それに対し，ス
テガノグラフィでは送信内容を別のデータに埋め込み，第三者から通信行為の存
在そのものを隠蔽することで，より安全な通信を実現することができる．

しかし，データの埋め込みによって，埋め込みに使用されたデータ（これをカバーデー
タという）内に誤りビットが発生し，それに伴うカバーデータの劣化
が情報の隠蔽性に問題を引き起こしてしまう．この誤りビットが発生する確率を
誤り率という．ステガノグラフィではカバーデータの劣化が目立たないようにデー
タを埋め込む必要があるが，同時に埋め込み可能なデータ容量は制限されてしま
うことから，低い誤り率でより多くの情報を効率よく埋め込むことが重要である．
この埋め込みの効率を埋め込み率という．

ステガノグラフィの代表的な手法としてLSB法が知られている．LSB法とは単純に
カバーデータのLSBと埋め込みデータのバイナリ表現をそのまま置き換えること
によって埋め込みを行なう手法である．この手法は，高い埋め込み率を有するが，
一方で，誤りビットが発生しやすくカバーデータが劣化しやすいという欠点を持
つ．その欠点を考慮した手法として誤りパターン埋め込み法がある．この手法は埋
め込みデータを誤りパターンというビット列に変換し，排他的論理和を用いて埋
め込みを行なうことでLSB法に比べ優れた誤り率を実現している．

文献\cite{Paper01}では埋込率に対する誤り率という側面から埋め込み手法の性
能評価を行っており，誤り率について誤りパターン埋め込み法がLSB法に比べ優
れているという結果を得ている．誤り率はステガノグラフィを評価する
上で重要な要素であるが，主観的評価の側面から言えば，必ずしも低い誤り率が
高い性能を示すとは限らない．例えば，誤りの生じたビットごとに重みをつけ平
均二乗誤差から求められるPSNRという画質劣化指標があるが，この指標は主観評
価と同様の結果が得られない場合が多々あるということが文献\cite{Paper03}に
おいて示されている．つまり，十分低いと考えられる誤り率で埋め込みを行った
としてもカバーデータによっては大きく劣化が生じてしまうということである．
このようなことから，ステガノグラフィを評価する上では誤り率だけではなく，
カバーデータの主観的劣化についても測定することが誤り率同様重要であると考
えられる．

% 例えば，誤り率がある値を示した際に画像データではほとん
% ど画質劣化が起きないが，音楽データでは同じ誤り率に対してひどい音質劣化を
% 起こすといったことがありうる．そのため，主観的評価の側面からステガノグラ
% フィを評価するには誤り率だけでなく，埋め込みによるカバーデータの表面的劣
% 化についても測定する必要があると考えられる．

% 同じ結果が得られるとは限らない．しかし，人間の主観による埋め込み検知を回避するにはカバーデータの
% 埋め込みによる表面的な劣化を抑える必要がある．一般的に誤り率が低いほど
% カバーデータの劣化は少なくなるが，ひとつの誤りが表面的劣化与える影響はカ
% バーデータによって異なる．

そこで，本論文ではグレースケール画像にテキスト情報を埋め込むステガノグラ
フィ技術を対象とし，誤りパターン埋め込み法における埋め込み率と誤り率，画
質劣化とのトレードオフ関係を実験的に明らかにする．その結果に対し，誤りパ
ターン埋め込み法を主観的観点から評価し，考察を行なう．なお，画質劣化の評
価指標として主観評価に近い評価指標であるSSIM\cite{Paper03}（Structual
Similarity）を用いる．また，誤りパターンテーブルの肥大化問題
\cite{Paper01}に対する解決策としてShalkwijkの数え上げ符号\cite{Paper02}
を用いた誤りパターンの動的生成手法を提案する．
}

\section{ステガノグラフィとは}{
ステガノグラフィとは秘密データを別の媒体に埋め込む技術，研究の総称であり，
情報ハイディング技術の一つでもある．

ステガノグラフィ以外の情報ハイディング技術として電子透かしがある．これ
はデータの著作権や所有権を保護するために，そのデータの中にある証拠データ
を埋め込む技術のことである．電子透かしでは埋め込まれる
証拠データの頑健さ，つまり第三者に除去されないことが重要となる．一般的に埋
め込まれる情報は少量であり，その情報を外部から確認できることが重要であ
る．そのため埋め込まれる証拠データそのものには大きな価値はない．

一方，ステガノグラフィでは秘密データを隠蔽するために，カバーデータへの埋め込
みを行なう．ステガノグラフィでは電子透かしとは逆に埋め込まれる秘密データそのもの
に大きな価値があり，埋め込まれた秘密データの存在そのものを第三者に認知され
ないことが重要となる．一般的に埋め込まれる情報は少量とは限らず，多量のデー
タの埋め込みはカバーデータを劣化させるため，第三者によって埋め込みを検知される
危険性が高まってしまう．そのため，ステガノグラフィでは以下の2点を同時に満たす
ことが強く望まれる．

\begin{itemize}
 \item できるだけ多くの情報の埋め込みが可能である
 \item 埋め込みが主観的・客観的に認知されない
\end{itemize}

カバーデータには主に音楽，画像などのメディアデータが用いられる．ほとんど
のメディアデータはいくらかの冗長性を有しており，これを利用した埋め込み
が主である．本論文で埋め込み対象とする画像では，画像中の各画素の下位ビッ
トが冗長性であり，これらのビットはそれぞれが持つ情報量が少なく，変化させ
たとしてもカバーデータの主観的変化はほとんど発生しない．特にLSBは情報量が最も少ないこ
とから，埋め込み利用されることが多い．実際，この特徴を利用した埋め込み手
法としてLSB法が提案されており，ステガノグラフィにおける最も一般的な埋め
込み手法として知られている．
}

\section{LSB法\label{sec:lsb_tecknique}}{
LSB法とは画像の各画素におけるLSBのみを埋め込み対象とすることで，埋め
込みによる画像の劣化を抑えた手法である．この手法は，図\ref{fig:lsb_emb}
に示すように，カバーデータ中のLSBに対しテキスト情報のバイナリ表現（以下
埋め込み，抽出されるデータはバイナリデータでありバイナリデータであること
をいちいち断らない）をそのまま置き換えることで埋め込みを行なう．このテキ
スト情報が埋め込まれたカバーデータをステゴデータという．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/lsb_emb.png}
 \end{center}
 \caption{LSB法でのデータの埋め込み}
 \label{fig:lsb_emb}
\end{figure}

テキスト情報の抽出時には図\ref{fig:lsb_ext}のように，ステゴデータにはテ
キスト情報がそのまま埋め込まれていることから，特別な処理なしに抽出する
ことができる．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=2.0cm]{img/lsb_ext.png}
 \end{center}
 \caption{LSB法でのデータの抽出}
 \label{fig:lsb_ext}
\end{figure}

単純なアルゴリズムであり実装が容易である反面，埋め込み後に誤
りビットが発生しやすく，ステゴデータの誤り率が高くなることから，ステゴデー
タの劣化によって隠蔽性に問題を引き起こしやすいという欠点がある．この欠点
に対し，これまでLSB法をもとに多数の手法が提案されてきた．それらの中でも
本論文で扱う誤りパターン埋め込み法は，優れた誤り率を有する手法として知ら
れている．


% これについては次章で述べる．

本論文ではカバーデータのうち，埋め込み対象となるビット列をカバービット
列，ステゴデータ中のデータが埋め込まれたビット列をステゴビット列と呼ぶ．
また，カバービット列とテキスト情報のビット長をそれぞれ$n$，$m$，ステゴビッ
ト列中の誤りビットの数を$d$として，埋め込み率は$\frac{m}{n}$，誤り率は
$\frac{d}{n}$として計算される．基本的に埋め込み率が高いほど多くの情報を
埋め込むことができ，誤り率が高いほどステゴデータの画質が劣化する傾向にあ
る．
}

\section{誤りパターン埋め込み法\label{sec:way_error_pattern}} {
LSB法に比べ優れた誤り率を有する手法として誤りパターン埋め込み法が知られ
ている．

LSB法では埋め込むごとに$\frac{1}{2}$の確率で誤りビットが発生するこ
とから，誤り率を$\Delta$，埋め込み率を$R$としてこれらの関係は
\[
 \Delta = \frac{R}{2}
\]
で表される．

\begin{figure*}[t]
 \begin{center}
  \includegraphics[width=\figureWidth]{img/lsb_error_theory.png}
 \end{center}
 \caption{LSB法と誤りパターン埋め込み法の性能比較}
 \label{fig:lsb_error_theory}
\end{figure*}

一方，誤りパターン埋め込み法の埋め込み率は次式のエントロピー関数$H(\Delta)$で表される．
\begin{eqnarray}
 H(\Delta) &\triangleq& H(\Delta, 1-\Delta) \nonumber \\
 &=& -\Delta\log_{2} \Delta - (1-\Delta)\log_{2} (1-\Delta) \nonumber
\end{eqnarray}

図\ref{fig:lsb_error_theory}にLSB法と誤りパターン埋め込み法の埋め込み率
と誤り率の関係を表したグラフを示す．図\ref{fig:lsb_error_theory}より，端
点を除き，明らかにLSB法に比べ誤りパターン埋め込み法は誤り率について優れ
ていることがわかる．

この手法では図\ref{fig:error_pt_emb}のように，テキスト情報を，冗長でかつ
ハミング重みの小さいビット列である誤りパターンへと変換する．そして，カバー
ビット列をそのまま置き換えるのではなく，カバービット列と誤りパターンとの
排他的論理和で置き換えを行なう．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/error_pt_emb.png}
 \end{center}
 \caption{誤りパターン埋め込み法でのデータの埋め込み}
 \label{fig:error_pt_emb}
\end{figure}

テキスト情報の抽出時には図\ref{fig:error_pt_ext}のように，カバービット列
とステゴビット列との排他的論理和をとることで埋め込まれた誤りパターンを抽
出することができ，その誤りパターンを変換することでテキスト情報を得る．こ
のような抽出方法となることからステゴデータの受信者はカバーデータを所持し
ている必要がある．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/error_pt_ext.png}
 \end{center}
 \caption{誤りパターン埋め込み法でのデータの抽出}
 \label{fig:error_pt_ext}
\end{figure}

この手法では埋め込みに排他的論理和を用いることから，誤りパターンにおける'1'の対応
するビットのみがカバービット列中で置き換わるため，誤りビットの発生を大幅に抑え
ることができる．一方でより長いビット列を使用することから埋め込み
率は減少する．また，テキスト情報から生成される誤りパターンのハミング重み
とステゴビット列中で発生する誤りビットの数が等しくなるため，同じテキスト情報を埋め込みデータとした場合，カバーデータによらず誤り率は等しくなる．
}

\section{誤りパターンの生成方法\label{sec:create_error_pt}} {
一般的な誤りパターンの生成方法として文字と誤りパターンとの対応を示した
誤りパターンテーブルを利用する方法がある．誤りパターンテーブルの例を表
\ref{tab:error_pt_table}に示す．

\begin{table}[h]
 \centering
 \caption{誤りパターンテーブル}
 \label{tab:error_pt_table}
 \begin{tabular}{|c|c|} \hline
  埋め込みデータ & 誤りパターン \\ \hline
  000 & 0000000 \\ \hline
  001 & 0000001 \\ \hline
  010 & 0000010 \\ \hline
  011 & 0000100 \\ \hline
  100 & 0001000 \\ \hline
  101 & 0010000 \\ \hline
  110 & 0100000 \\ \hline
  111 & 1000000 \\ \hline
 \end{tabular}
\end{table}

この方法ではテキスト情報の埋め込み時，抽出時にテーブル
を参照することで誤りパターンの相互変換を行う．単純な方式であり実装が容易である一方で，
テキスト情報の各文字を$m$ビットとしたとき，最大で$2^m$個の誤りパ
ターンを対応付ける必要があることから，テーブルが膨大となりやすく，強い
メモリ制約下での実装が困難になるという問題がある．

本論文では，この問題の解決策としてShalkwijkの数え上げ符号\cite{Paper02}
を用いた誤りパターンの動的生成手法を提案する．
}

\subsection{Slalkwijkの数え上げ符号\label{sec:shalkwijk}}{
Shalkwijkの数え上げ符号とは長さ$n$，ハミング重み$k$の２進数列xの
集合に対し10進数$i(x)$を一意に割り当てることができる符号化手法である．な
おi(x)は
\begin{center}
 \[
 0 \leq i(x) \leq {}_n C_k
 \]
\end{center}
を満足する．

\begin{figure}[hdbp]
 \pascaltrig{7}
 \caption{パスカルの三角形}
 \label{fig:pascale}
\end{figure}

また，図\ref{fig:pascale}に示すようなパスカルの三角形を用いて$x$，$i(x)$間の
相互変換が可能である．この方法ではパスカルの三角形における$n+1$段目，左
から$k+1$番目の値を起点として変換処理を行う．一例として$x= 010100$とした
ときの符号化について考える．この$x$は$n = 6$，$k = 2$であるからまず頂点
の$1$から数えて$7$段目，左から$3$番目の値である$15$に注目する．ここで$x$
のMSBから$1$ビットずつ値を取り出していき，$0$であれば右斜め上に，$1$なら
ば左斜め上の値に注目点を移動する．また取り出した値が$1$であったとき注目
点を移動する前の値から見て右斜め上の値を記憶し加算していく．今回の場合，
MSBが$0$であるから右斜め上の$10$に移動する．そして次のビットは$1$である
から右斜め上の$6$を記憶し，左斜め上の$4$に移動する．これを繰り返し，頂点
に達した時点で終了となる．今回の場合，最終的に加算していった値として$8$
が得られ，これが$x$に割り当てられる$i(x)$となる．

次に，$i(x)$から$x$への復号化について考える．復号化では注目点から見て右斜
め上の値と$i(x)$とを比較し，MSBから順に各ビットの値が決定される．比較対
象となる値を$n$として$ i(x) < n$であれば決定されるビットは$0$となり，注
目点を右斜め上の値移動する．$ i(x) \geq n$であれば決定されるビットは$1$
となり，左斜め上の値に移動し，$i(x) = i(x) - n$としてi(x)の値を減らして
いく．今回の場合，起点である$15$から見て右斜め上の値は$10$であり，これよ
りも$8$は小さいことからMSBは$0$であることが決まり，そのまま右斜め上の
$10$に移動する．次に，$10$の位置から見ると右斜め上の値は$6$であり$8$のほ
うが大きいことから左斜め上の$4$に移動し，次のビットは$1$とする．このとき，
値$8$から$6$を引いた値である$2$を記憶する．これを繰り返していくことによっ
て最終的に$010100$が得られる．これが$n = 6, k = 2$とした場合に$8$に対応
する$x$ということになる．最終的に$n =6, k = 2$の2進数列$x$の集合は10進数
$i(x)$が表\ref{tab:shalkwijk}のように割り当てられる．

\begin{table}[h]
 \centering
 \caption{$n = 6, k = 2$の場合の対応付け}
 \label{tab:shalkwijk}
 \begin{tabular}{|c|c|c|c|} \hline
  $x$    & $i(x)$ & $x$    & $i(x)$ \\ \hline
  000011 & 0      & 010100 & 8      \\ \hline
  000101 & 1      & 011000 & 9      \\ \hline
  000110 & 2      & 100001 & 10     \\ \hline
  001001 & 3      & 100010 & 11     \\ \hline
  001010 & 4      & 100100 & 12     \\ \hline
  001100 & 5      & 101000 & 13     \\ \hline
  010001 & 6      & 110000 & 14     \\ \hline
  010010 & 7      &        &        \\ \hline
 \end{tabular}
\end{table}

}

\subsection{誤りパターンの動的生成\label{sec:dynamic_error_pt}}{
提案する手法ではテキスト情報の各文字を2進数列$x$として与えることで，10進
数$i(x)$へと変換する．この変換は\ref{sec:shalkwijk}で述べたパスカルの三
角形を用いて行なう．このとき，$x$が一意である一方で，異なる$x$に対し同じ
$i(x)$が割り振られる場合がある．例えば，表\ref{tab:shalkwijk}で$x =
000011$に割り当てられる$i(x)$は$0$であるが，$x = 000000$に対しても同様に
$0$が割り当てられる．そこで，本手法では$x$の長さ$n$，ハミング重み$k$を用
いて次式で求められるoffset$_k$をi(x)に加算することで一意の誤りパターンと
する．

\[
  \mbox{offset}_k = \begin{cases}
    0 & (k=0) \\
    {\displaystyle \sum_{i=0}^{k-1}} {_n C_i} & (k \geq 1)\\
  \end{cases}
\]

この方法を用いることで誤りパターンを動的に生成し，強いメモリ制約下での誤
りパターン変換を可能とする．
}

\section{SSIM} {
SSIMは人間の視覚特性が考慮された画質評価の指標であり，主観評価との相関が
高いことで知られている．SSIMの値は，比較される画像をx,yとし，それぞれの
各画素とその周辺画素について画素値の平均$\mu_{y}{,}\mu_{x}$分散
$\sigma_{x}{,}\sigma_{x}$共分散$\sigma_{xy}$を用いて以下の式で算出される．

\[
  {\rm SSIM}(x,y) = \frac
  {(2\mu_{x}\mu_{y} + C_{1})(2\sigma_{xy} + C_{2})}
  {(\mu_{x}^2 + \mu_{y}^2 + C_{1})(\sigma_{x}^2 + \sigma_{y}^2 + C_{2})}
\]

ここで$C_{1}，C_{2}$は式の分母を０としないために加算される定数であり，任
意のパラーメータ$K_{1}，K_{2}$によって決定される．これらは画像x,yの１画
素あたりの階調を$L$として次式で表される．

\begin{eqnarray}
 C_{1} = (K_{1}L)^2 \nonumber \\
 C_{2} = (K_{2}L)^2 \nonumber
\end{eqnarray}

代表的な画質劣化指標としてPSNRがあるが，これに比べSSIMは主観評価との相関
が高く，より正確に画質を評価できることから本論文ではSSIMを用いることとし
た．

実際にSSIMを測定する際には，パラメータ$K_{1}, K_{2}$，計算プログラム上で使用され
るガウシアンフィルタの偏差値，サイズにはSSIMの考案者であるZhouWangら自身が公開し
ているMATLABのSSIM計算プログラム\cite{Code}とまったく同じ値を用いること
とし，$K_{1} = 0.1，K_{2} =0.3，偏差値 = 1.5，フィルタサイズ = 11$とした．
}

\begin{figure*}[htbp]
 \begin{center}
  \includegraphics[width=\figureWidth]{img/graph_error_rate.png}
 \end{center}
 \caption{埋め込み率に対する誤り率の変化}
 \label{fig:graph_error_rate}
\end{figure*}

\section{カバーデータの劣化評価}
\subsection{評価手順} {
評価実験の手順の概要を図\ref{fig:experiment1}に示す．以下に示す手順で実験を
行い，この結果について考察を行った．実験には256$\times$256pxの8ビットグ
レイスケールBitmapであるSIDBA画像30枚を使用し，埋め込みに使用するテキス
ト情報は等確率で発生する8ビットコードの列とした．テキスト情報の生成には
623次元に分布する乱数発生器であるSFMTを用いた．

\begin{enumerate}
\renewcommand{\labelenumi}{(\arabic{enumi})}
 \item テキスト情報の各コードを\ref{sec:dynamic_error_pt}章にて述べた手
       法で動的に誤りパターンへと変換し，変換した誤りパターンと画像のLSB
       との排他的論理和を画像へと埋め込む．\label{enum:experiment1-1}
 \item 埋め込み前後の画像を比較し，誤り率，SSIMを算出する．\label{enum:experiment1-2}
 \item 誤りパターン長を8ビットから255ビットまで変化させ（\ref{enum:experiment1-1}），（\ref{enum:experiment1-2}）を繰り返す．\label{enum:experiment1-3}
 \item 画像を入れ替えて（\ref{enum:experiment1-3}）を繰り返す．
\end{enumerate}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/experiment01.png}
 \end{center}
 \caption{実験概要}
 \label{fig:experiment1}
\end{figure}

}

\subsection{評価結果}
\subsubsection{埋め込み率に対する誤り率}{

誤り率の計測結果と文献\cite{Paper01}において示されている誤りパターン埋め
込み法における誤り率の理論的下限曲線を図\ref{fig:graph_error_rate}に示す．
なお，誤りパターン埋め込み法における誤り率はカバーデータによらず等しいこ
とから，すべてのカバーデータに対し同じ曲線を描く．

 図\ref{fig:graph_error_rate}より，実際に計測した誤り率は理論的下限曲線
と同様，埋め込み率が増加するとともに誤り率も増加し，理論的下限曲線に比べ
曲率の低い曲線を描いた．
}

\subsubsection{埋め込み率に対する画質劣化\label{sec:result_ssim1}}{
30枚のSIDBA画像のうち，SSIMの最も高い画像10枚と最も低い画像10枚の埋め込み率に対
するSSIMの変化を図\ref{fig:graph_ssim1}に示す．

\begin{figure*}[t]
 \begin{center}
  \includegraphics[width=\figureWidth]{img/graph_ssim_lsb_only.png}
  \caption{埋め込み率に対するSSIMの変化（画像ごと）}
  \label{fig:graph_ssim1}
 \end{center}
\end{figure*}

図\ref{fig:graph_ssim1}よりすべての埋め込み率についてSSIMが0.99を上回って
いることがわかる．一般的にSSIMは0.98以上で埋め込み前後の画像の区別がつか
ないと言われていることから，LSBのみをカバービット列とした場合，埋め込み
率，誤り率によって画質が大きく劣化することはなく，視覚的な隠蔽性に大きく
影響を与える

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/BRIDGE.png}
  \caption{BRIDGE.bmp}
  \label{fig:best_ssim_image}
 \end{center}
\end{figure}

\noindent ことはないということがわかる．同時に図\ref{fig:graph_ssim1}
より，画像ごとにSSIMの変化の様子が異なることがわかる．これについて，実験
に使用した画像を主観的に観察したところ，図\ref{fig:best_ssim_image}のよ
うに画像全体の複雑度が高い画像ほどSSIMの変化が小さく，一方で図
\ref{fig:least_ssim_image}のように複雑度の低い大きな領域を含む画像ほど
SSIMの変化が大きくなるという傾向が見られた．ここで複雑度とは，

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/Balloon.png}
  \caption{Balloon.bmp}
  \label{fig:least_ssim_image}
 \end{center}
\end{figure}

\noindent 画像全体に
おける画素間の明暗の変化の多さを表しており，複雑度が高いほどにノイズ画像
に近くなる．これは，埋め込まれるデータ内の0,1の発生はランダムであり，埋
め込みによる画像の劣化がノイズ状に発生することから，図
\ref{fig:best_ssim_image}のように複雑度が高い画像であれば，画像中にノイ
ズが溶け込み，目立たなくなってしまうためであると考えられる．
}

\subsubsection{２ビット列目以降へ埋め込んだ場合の画質劣化
   \label{sec:more_bit_prane}}{
章\ref{sec:result_ssim1}よりLSBのみをカバービット列とした場合にステゴデー
タの劣化はほとんど起こらず，視覚的な隠蔽性には大きく影響を与えないということが
わかった．このことから視覚的な隠蔽性に影響を与えない範囲で2ビット列目以降への埋
め込みも可能であると仮定し，さらに2〜4ビット列目までをカバービット列とし
て加え，これまでと同様の手順で実験を行った．このとき，カバービット列中の
最上位ビット以外のビット列については埋め込み率100％での埋め込みを行った．実験
結果をそれぞれ図\ref{fig:graph_ssim2}〜\ref{fig:graph_ssim4}に示す．

\begin{figure*}[t]
 \centering
 \includegraphics[width=\figureWidth]{img/graph_ssim_second_plane.png}
 \caption{2ビット列目を加えた場合}
 \label{fig:graph_ssim2}
\end{figure*}

\begin{figure*}[t]
 \centering
 \includegraphics[width=\figureWidth]{img/graph_ssim_third_plain.png}
 \caption{3ビット列目を加えた場合}
 \label{fig:graph_ssim3}
\end{figure*}

\begin{figure*}[t]
 \centering
 \includegraphics[width=\figureWidth]{img/graph_ssim_fouth_plain.png}
 \caption{4ビット列目を加えた場合}
 \label{fig:graph_ssim4}
\end{figure*}

\begin{figure*}[b]
 \begin{center}
  \begin{tabular}{c}

   \begin{minipage}{0.5\hsize}
    \begin{center}
     \includegraphics[width=7cm]{img/8_7_BRIDGE.png}
     \caption{BRIDGE.bmpのステゴデータ}
     \label{fig:best_ssim_image_emb}
    \end{center}
   \end{minipage}

   \begin{minipage}{0.5\hsize}
    \begin{center}
     \includegraphics[width=7cm]{img/8_7_Balloon.png}
     \caption{Balloon.bmpのステゴデータ}
     \label{fig:least_ssim_image_emb}
    \end{center}
   \end{minipage}
  \end{tabular}
 \end{center}
\end{figure*}

図\ref{fig:graph_ssim2}より埋め込み率$0.9$前後でSSIMが$0.98$を下回り始め
ていることがわかる．このことから，LSBと2ビット列をカバービット列とするこ
とで，ほとんどの画像に対し，視覚的な隠蔽性に大きく影響を与えない範囲で，約1.9
倍のテキスト情報の埋め込みが可能であることがわかる．

図\ref{fig:graph_ssim3}より３ビット列目まで埋め込み率100％での埋め込
みを行ったとしてもSSIMが0.98を上回る画像があることがわかる．また，図
\ref{fig:graph_ssim4}においても埋め込み率0.2前後までSSIMが0.98を上回って
いることがわかる．

ここで，図\ref{fig:best_ssim_image}，\ref{fig:least_ssim_image}のステゴ
データをそれぞれ図\ref{fig:best_ssim_image_emb}，
\ref{fig:least_ssim_image_emb}に示す．ステゴデータはLSBから3ビット列目ま
で埋め込み率100％で埋め込みを行ったものである．図
\ref{fig:least_ssim_image_emb}は複雑度が低く，もとの画像に比べ大きく画質
劣化が生じている．一方で図\ref{fig:best_ssim_image_emb}は複雑度が高
く，元の画像からほとんど画質劣化が生じていない．これらのことから複雑度の高い画像
を使用することででカバービット列をLSBのみとした場合に比べ，視覚的な隠蔽
性に影響を与えない範囲で3倍以上のテキスト情報の埋め込みが可能になるといえる．
}

\subsubsection{埋め込む文字数を一定にした場合の画質劣化}{
埋め込まれるテキスト情報の文字数を固定して誤りパターン長を長くした場合，
埋め込みに必要となるステゴビット列は長くなるが，ステゴデータの誤り率を下
げることができる．

例えば，カバービット列をLSBのみとして埋め込み率100％，すなわち誤りパターン長を8ビットとして埋
め込みを行った場合，256$\times$256pxの画像であれば8192文字のテキスト情報
の埋め込みが可能である．これに対し，誤りパターン長を16ビットとして8192文
字のテキスト情報を埋め込んだ場合，LSBに加え2ビット列目をカバービット列と
する必要があるが，誤りパターン長が倍となることから誤り率を半減させること
ができる．

しかし，一般的に誤り率を下げることで画質劣化を抑えることができるが，２ビッ
ト列目はLSBに比べ，各ビットが倍の情報量を持つことから誤りビットによるス
テゴデータの主観的変化が大きくなる．

これについて，埋め込む文字数を固定し，カバービット列をLSBのみとした場合，
LSBと2ビット列目とした場合について，後者の場合により画質劣化を抑えること
ができると仮定し，これまでと同様の実験手順でステゴデータの画質劣化の比較
を行った．

実験で使用した30枚のSIDBA画像のうちBRIDGE.bmp（図
\ref{fig:best_ssim_image}）を使用した場合の実験結果を図
\ref{fig:graph_vs_same_message_length}に示す．図
\ref{fig:graph_vs_same_message_length}より，埋め込む文字数にかかわらず，
カバービット列をLSBと2ビット列目とした場合のSSIMが，LSBのみとした場合の
SSIMを下回っていることがわかる．この結果から，誤りパターン長を長くしたと
しても，より重みのあるビット使用した場合，画質劣化を抑えることはできない
ということがわかる．また，他の画像についても同様の結果が得られている．

\begin{figure*}[t]
 \begin{center}
  \includegraphics[width=\figureWidth]{img/graph_same_message_length.png}
 \end{center}
 \caption{埋め込み率に対する誤り率の変化}
 \label{fig:graph_vs_same_message_length}
\end{figure*}
}

\section{おわりに}{
 本研究では誤りパターン埋め込み法における埋め込み率と誤り率，画質劣化と
のトレードオフ関係を実験的に明らかにした．これによって，LSBのみをカバー
ビット列とした場合，埋め込み率，誤り率によって画質が大きく劣化することは
なく，ステゴデータの視覚的な隠蔽性に大きく影響を与えることはないというこ
とがわかった．この結果を受け，さらに2ビット〜4ビット列目をカバービット
えて実験を行い，視覚的な隠蔽性に大きく影響を与えない範囲で，LSBのみをカ
バービット列とした場合に比べ1.9〜3.0倍のテキスト情報を埋め込むことができ
るということを示した．

 また，Shalkwijkの数え上げ符号を用いた誤りパターンへの動的生成手法を提
案することで，強いメモリ制約下における誤りパターンテーブルの実装問題に対
する解決策を示した．しかし，本論文の実験で使用した環境は決してメモリ制約の強い
環境ではないため，今後実際に強いメモリ制約下での動作比較実験を行う必要が
あると思われる．
}

%-------------------------------------------references
\bibliographystyle{junsrt}
\bibliography{report}

\newpage
\newpage

\newgeometry{top=3cm,hmargin=2.3cm,textheight=24.8cm,textwidth=17cm}
\setcounter{page}{1}
\renewcommand{\thepage}{\roman{page}}
\appendix
\section{実験環境}{
\begin{itemize}
 \item OS  : Mac OS X 8，9
 \item RAM : 8GB 1600 MHz DDR3
 \item IDE : Intellij IDEA 13.0
\end{itemize}
}

\section{画像の入手元} {
\begin{enumerate}
 \item 神奈川大学 \\
       \url{http://www.ess.ic.kanagawa-it.ac.jp/app_images_j.html}
 \item 京都大学 \\
       \url{http://vision.kuee.kyoto-u.ac.jp/IUE/IMAGE_DATABASE/STD_IMAGES/index.html}
 \item Ashi-LAB \\
       \url{http://asssy.sakura.ne.jp/idba.html}
 \item Rensselaer Polytechnic Institute \\
       \url{http://www.cipr.rpi.edu/resource/stills/index.html}
\end{enumerate}
}

\end{document}