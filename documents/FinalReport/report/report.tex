\documentclass[a4j,10pt]{jsarticle}
\usepackage{ipsj}
\usepackage[top=4cm,hmargin=3cm,textheight=24.8cm,textwidth=17cm]{geometry}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage{txfonts}
\usepackage[symbol*,perpage]{footmisc}
\usepackage[dvipdfm]{graphicx, color}
\usepackage{tcpascaltrig}
\usepackage{url}
% \usepackage[hang, center]{caption}
% \captionsetup[table]{labelsep=space}
% \captionsetup[figure]{labelsep=space}

%------------------------------------------- define sections
% \titlelabel{\thetitle. \quad}
% \renewcommand{\thesection}{\arabic{section}.}
\setcounter{tocdepth}{3}

%-------------------------------------------jtitle and jauthors information
\begin{document}
{\begin{titlepage}
\begin{center}

 \newlength{\titleLineSpace}
 \setlength{\titleLineSpace}{15pt}

 \newlength{\marginBetweenTitle}
 \setlength{\marginBetweenTitle}{10pt}

 \newlength{\marginUnderTitle}
 \setlength{\marginUnderTitle}{45pt}
 
 \newlength{\marginUnderAuthor}
 \setlength{\marginUnderAuthor}{45pt}
 
 \newlength{\marginUnderCollege}
 \setlength{\marginUnderCollege}{55pt}

 \newlength{\marginUnderAbstract}
 \setlength{\marginUnderAbstract}{20pt}
 
 {\LARGE 誤りパターン埋込み型ステガノグラフィに \\
 \vspace{\titleLineSpace} 関する一考察} \\

 \vspace{\marginBetweenTitle}
 
 {\LARGE\bf A study on steganography \\ \vspace{\titleLineSpace} based on embedding error patterns}

 \vspace{\marginUnderTitle}

 {\large 研究者 : 索手　一平 \hspace{80pt} 指導教員 : 福岡　久雄} \\
 {\large Researcher : Ippei NAWATE \hspace{40pt} Supervisor : Hisao FUKUOKA}

 \vspace{\marginUnderAuthor} 

 {\large 松江工業高等専門学校情報工学科} \\
 {\large Department of Information Engineering, Matsue College of
 Technology}

 \vspace{\marginUnderCollege}

 {\large\bf 概要} \\

 \begin{flushleft}
  {\small 本論文は，テキスト情報をグレースケール画像に埋め込むステガ
  ノグラフィ技術を対象とする．データの埋め込み手 法の一つである誤りパター
  ン埋め込み法は，テキスト情報を冗長かつハミング重みの小さい誤りパター
  ンというビット列に変換し，画像中のLSB平面との排他的論理和でLSB
  平面を置き換える．本研究では，誤りパターン埋め込み法における画質劣化等に
  ついて考察する．また，Shalkwijkの数え上げ符号を用いた誤りパターンの動的
  生成方法を提案する．}
 \end{flushleft}

 {\large\bf Abstract} \\

 \begin{flushleft}
  {\small

  The subject of this paper studies is steganography techniques to embed text information
  into gray scale images. Tnhe steganography method of error pattern is one of the methods of embedding data. In embedding process of this method, first of all, the binary data of
  each character in text information are converted into error
  pattern which more shorter and less hamming weight binary digit string.
  Finally, replacing LSB plane of the embedding target image with the exclusive OR of
  error pattern and that LSB plane of the image. In this study, we consider the image quality
  etc of the image embedded text information. Then this paper also proposes a method of
  dynamically generating the error pattern using the enumerative code.
  
  }
 \end{flushleft}

 
 \vspace{\marginUnderAbstract}
 
 {\large\bf Keywords} \\
 {\normalsize ステガノグラフィ，セキュリティ，誤りパターン，数え上げ符号}

\end{center} 
\end{titlepage}}

\newgeometry{top=3cm,hmargin=2.3cm,textheight=24.8cm,textwidth=17cm}


\tableofcontents
\thispagestyle{empty}
\newpage


\setcounter{page}{1}
\newgeometry{top=3cm,bottom=3cm,hmargin=2.3cm,textheight=24.8cm,textwidth=17cm,twocolumn=true}

\section{はじめに}{
近年，ネットワーク通信の増加に伴い，安全に通信を行うための技術の重要性が
高まってきている．安全に通信を行う手段として送信内容の暗号化が挙げられる．
暗号化を施すことで，第三者による盗聴，なりすましといった妨害行為を防ぐこ
とができるが，通信行為そのものは第三者に認知されてしまうことから，通信経
路の遮断などといった妨害行為をうける可能性を排除できない．

この点に対し，ステガノグラフィでは送信内容を別のデータに埋込むことで，第
三者から秘密データの存在そのものを隠蔽する．これによって，通信行為そのもの
を隠蔽し，より安全な通信を実現することができる．

しかし，データの埋め込みによって，埋め込みに使用されたデータ（これを「カバー
データ」という）には誤りビットが発生することから，それに伴うカバーデータの
劣化が情報の隠蔽性に問題を引き起こしてしまう．この誤りビットが発生する割
合を「誤り率」という．このことから，カバーデータのが大きくならない
範囲でデータを埋め込む必要があり，それと同時に埋め込み可能なデータ容量が
制限されてしまう．

そのため，ステガノグラフィでは誤りを抑えつつ，より多くの情報を効率よく埋
め込むことが重要である．この埋め込みの効率を「埋め込み率」という．今まで複数の埋
め込み手法が提案されてきており，その中でも代表的なものがLSB法である．文
献\cite{Paper01}ではLSB法とそれを改良した誤りパターン埋め込み法について
の性能比較を行っている．

しかし，文献\cite{Paper01}で行われた性能比較は埋め込み率に対する理論的な
誤り率の比較にとどまっており，実際の埋め込みによる誤り率については述べら
れていない．また，実用する上で重要となる，埋め込みに伴うカバーデータの劣
化についても述べられていない．

そこで，本論文ではテキスト情報をグレイスケール画像に埋め込むステガノグラ
フィ技術を対象として，誤りパターン埋め込み法における埋め込み率と誤り率，
画質劣化とのトレードオフ関係を実験的に明らかにする．なお，画質劣化の指標
にはSSIM\cite{Paper03}を用いる．また，誤りパターンテーブルの肥大化問題
\cite{Paper01}に対する解決策としてShalkwijkの数え上げ符号\cite{Paper02}
を用いた誤りパターンの動的生成手法を提案する．
}

\section{ステガノグラフィとは}{
ステガノグラフィとは秘密データを別の媒体に埋め込む技術，研究の総称であり，
情報ハイディング技術の一つでもある．

ステガノグラフィ以外の情報ハイディング技術として電子透かしがある．これ
はデータの著作権や所有権を保護するために，そのデータの中
に，ある証拠データを埋め込む技術のことである．電子透かしでは埋め込まれる
証拠データの頑健さ，つまり他者に除去されないことが重要である．一般的に埋
め込まれる情報は少量であり，外部から確認できることが重要であり，埋め込ま
れる証拠データそのものには大きな価値はない．

一方でステガノグラフィは秘密データを隠蔽するためにカバーデータ内に埋め込
みを行なう．ステガノグラフィでは電子透かしとは逆に埋め込まれる秘密データそのもの
に大きな価値があり，埋め込まれた秘密データの存在そのものを他者に認知され
ないことが重要となる．一般的に埋め込まれる情報は少量とは限らず，多量のデー
タの埋め込みはカバーデータを劣化させてしまい，第三者に埋め込みを検知され
る危険性が高まることから，ステガノグラフィでは以下の2点を同時に満たす
ことが強く望まれる．

\begin{enumerate}
 \item できるだけ多くの情報の埋め込みが可能である
 \item 埋め込みが主観的・客観的に認知されない
\end{enumerate}

また，秘密データを埋め込まれたカバーデータをステゴデータと呼ぶ．

カバーデータには主に音楽，画像などのメディアデータが用いられる．ほとんど
のメディアデータはいくらかの冗長性を有しており，これを利用した埋め込み
が主である．本論文で埋め込み対象とする画像では，画像中の各画素におけるLSBなどの
下位ビットが冗長性となる．これらのビットはそれぞれが持つ情報量が少なく，
変化させたとしても視覚的変化がほとんど発生しない．特にLSBは情報量が最も
少ないことから，埋め込み利用されることが多い．実際，この特徴を利用した埋
め込み手法としてLSB法が提案されており，ステガノグラフィにおける最も一般
的な埋込み手法として知られている．これについて次章で述べる．
}

\section{LSB法\label{sec:lsb_tecknique}}{
LSB法とは画像の各ピクセルにおけるLSBのみを埋め込み対象とすることで，埋め
込みによる画像の劣化を抑えた手法である．この手法は，図\ref{fig:lsb_emb}
に示すように，カバーデータ中のLSBに対しテキスト情報のバイナリ表現をその
まま置き換えることで埋め込みを行なう．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/lsb_emb.png}
 \end{center}
 \caption{LSB法でのデータの埋め込み}
 \label{fig:lsb_emb}
\end{figure}

また，埋め込み時にLSBをテキスト情報のバイナリ表現でそのまま置き換えること
から，図\ref{fig:lsb_ext}のようにステゴデータのLSBのからテキスト情報を直
接抽出することができる．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=2.0cm]{img/lsb_ext.png}
 \end{center}
 \caption{LSB法でのデータの抽出}
 \label{fig:lsb_ext}
\end{figure}

この手法は，単純なアルゴリズムであり実装が容易である反面，埋め込み後に誤
りビットが発生しやすく，ステゴデータの誤り率が高くなる．このことから，誤
りに伴うステゴデータの劣化によって，情報の隠蔽性に下げてしまう．

このような問題から，これまでLSB法をもとに多数の手法が提案されてきた．そ
れらの中でも本論文で扱う誤りパターン埋め込み法は，優れた誤り率を有する手
法として知られている．これについては次章で述べる．

本論文ではカバーデータのうち，埋め込みに対象となるビット列をカバービット
列，ステゴデータ中のデータが埋め込まれたビット列をステゴビット列と呼ぶ．
また，カバービット列とテキスト情報のバイナリ表現のビット長をそれぞれ
$n$，$m$，ステゴビット列中の誤りビットの数を$d$として，埋め込み率は$\frac{m}{n}$
，誤り率は$\frac{d}{n}$として計算される．

基本的に埋め込み率が高いほど多くの情報を埋め込むことができる．また，誤り
率が高いほどステゴデータの画質が劣化する傾向にある．LSB法では埋め込み率
は常に100％であるが，一方で誤りビットが発生しやすいことから誤り率が高い．
}

\section{誤りパターン埋め込み法\label{sec:way_error_pattern}} {
LSB法をもとに，より低い誤り率での埋め込みを行なう手法として誤りパター
ン埋め込み法が知られている．

文献\cite{Paper01}ではLSB法とこの手法の誤り率についての性能比較を行って
いる．LSB法では埋め込むごとに$\frac{1}{2}$の確率で誤りビットが発生するこ
とから，誤り率を$\Delta$，埋め込み率を$R$としてこれらの関係は
\[
 \Delta = \frac{R}{2}
\]
で表される．

一方，誤りパターン埋め込み法の埋め込み率は式(\ref{equ:entropy})のエントロピー関数$H(\Delta)$で表される．
\begin{eqnarray}
 H(\Delta) &\triangleq& H(\Delta, 1-\Delta) \nonumber \\
 &=& -\Delta\log{2} \Delta - (1-\Delta)\log{2} (1-\Delta)
  \label{equ:entropy}
\end{eqnarray}

図\ref{fig:lsb_error_theory}にLSB法と誤りパターン埋め込み法の埋め込み率
と誤り率の関係を表したグラフを示す．図\ref{fig:lsb_error_theory}より，明
らかにLSB法に比べ誤りパターン埋め込み法は誤り率について優れていることが
わかる．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_lsb_error_theory.png}
 \end{center}
 \caption{LSB法と誤りパターン埋め込み法の性能比較}
 \label{fig:lsb_error_theory}
\end{figure}

この手法では図\ref{fig:error_pt_emb}のように，次章にて述べる変換方式を用いてテ
キスト情報のバイナリ表現を，より長くハミ
ング重みの小さいビット列である誤りパターンに変換する．そして，カバービッ
ト列をそのまま置き換えるのではなく，カバービット列と誤りパターンとの排他
的論理和でカバービット列を置き換える．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/error_pt_emb.png}
 \end{center}
 \caption{誤りパターン埋め込み法でのデータの埋め込み}
 \label{fig:error_pt_emb}
\end{figure}

また，図\ref{fig:error_pt_ext}のように，カバービット列とステゴビット列と
の排他的論理和をとることで埋め込まれた誤りパターンを抽出することができ，その誤りパター
ンをテキスト情報へと逆変換することでテキスト情報の抽出を行うことができる．



\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/error_pt_ext.png}
 \end{center}
 \caption{誤りパターン埋め込み法でのデータの抽出}
 \label{fig:error_pt_ext}
\end{figure}

埋め込みに排他的論理和を用いることから，誤りパターンにおける「１」の対応
するビットのみがカバービット列中で置き換わるため，誤りビットの発生を大幅に抑え
ることができる．一方でより長いビット列を使用することから埋め込み
率は減少する．

この手法において，ステゴビット列中で発生する誤りビットの数は誤りパターンのハ
ミング重みと同じであり，生成される誤りパターンが埋め込まれるテキスト情報
によることから，誤り率はテキスト情報の内容に依存する．そのため同じテキス
ト情報を埋め込みデータとした場合，カバーデータによらず誤り率は等しくなる．ま
た，テキスト情報の抽出時にカバービット列とステゴビット列の排他的論理和を用いるこ
とから，この手法は埋め込みデータの抽出にカバーデータが必要となる．
}

\section{誤りパターンの生成方法\label{sec:create_error_pt}} {
一般的な誤りパターンの生成方法として文字のバイナリ表現と誤りパターンとの対応を示した
誤りパターンテーブルを利用した方法がある．誤りパターンテーブルの例を表
\ref{tab:error_pt_table}に示す．この方法ではテキスト情報の埋め込み時，抽出時にテーブル
を参照することで誤りパターンの相互変換を行う．単純な方式であり実装が容易である一方で，
テキスト情報の各文字のバイナリ表現を$m$ビットとしたとき，最大で$2^m$個の誤りパ
ターンを対応付ける必要があることから，テーブルが膨大となりやすく，強い
メモリ制約下での実装が困難になるという問題がある．

\begin{table}[h]
 \centering
 \caption{誤りパターンテーブル}
 \label{tab:error_pt_table}
 \begin{tabular}{|c|c|} \hline
  埋め込みデータ & 誤りパターン \\ \hline
  000 & 0000000 \\ \hline
  001 & 0000001 \\ \hline
  010 & 0000010 \\ \hline
  011 & 0000100 \\ \hline
  100 & 0001000 \\ \hline
  101 & 0010000 \\ \hline
  110 & 0100000 \\ \hline
  111 & 1000000 \\ \hline
 \end{tabular}
\end{table}

文献\cite{Paper01}ではこの問題の解決策として，コスト付き符号化を用いた誤
りパターンテーブルの効率的実装方法が提案されている．

本論文では誤りパターンテーブルを用いない解決策として，Shalkwijkの数え上げ
符号\cite{Paper02}を用いた誤りパターンの動的生成手法を提案する．

}

\subsection{Slalkwijkの数え上げ符号\label{sec:shalkwijk}}{
Shalkwijkの数え上げ符号とは長さ$n$，ハミング重み$k$の２進数列xの
集合に対し10進数$i(x)$を一意に割り当てることができる符号化手法である．な
おi(x)は
\begin{center}
 \[
 0 \leq i(x) \leq {}_n C_k
 \]
\end{center}
を満足する．

\begin{figure}
 \pascaltrig{7}
 \caption{パスカルの三角形}
 \label{fig:pascale}
\end{figure}

またパスカルの三角形を用いて$x$，$i(x)$間の相互変換が可能である．この方
法ではパスカルの三角形における$n+1$段目，左から$k+1$番目の値を起点として変換を行う．
一例として$x= 010100$としたときの符号化について考える．この$x$は
$n = 6$，$k = 2$であるからまず頂点の$1$から数えて$7$段目，左から$3$番目
の値である$15$に注目する．ここで$x$のMSBから$1$ビットずつ値を取り出して
いき，
$0$であれば右斜め上に，$1$ならば左斜め上の値に注目点を移動する．また取り出した値が
$1$であったとき注目点を移動する前の値から見て右斜め上の値を記憶し加算し
ていく．今回の場合，MSBが$0$であるから右斜め上の$10$に移動する．そして次のビットは
$1$であるから右斜め上の$6$を記憶し，左斜め上の$4$に移動する．これを繰り
返し，頂点に達した時点で終了となる．今回の場合，最終的に加算
していった値として$8$が得られ，これが$x$に割り当てられる$i(x)$となる．


次に$i(x)$から$x$への復号化について考える．
復号化では注目点から見て右斜め上の値と$i(x)$とを比較し，MSBから順に各ビッ
トの値が決定される．比較対象となる値を$n$として$ i(x) < n$であれば決定さ
れるビットは$0$となり，注目点を右斜め上の値移動する．$ i(x) \geq n$であ
れば決定されるビットは$1$となり，左斜め上の値に移動し，$i(x) = i(x) - n$としてi(x)の値を減らし
ていく．今回の場合，起点である$15$から見て右斜め上
の値は$10$であり，これよりも$8$は小さいことからMSBは$0$であることが決ま
り，そのまま右斜め上の$10$に移動する．次に，$10$の位置から見ると右斜め上の値は
$6$であり$8$のほうが大きいことから左斜め上の$4$に移動し，
次のビットは$1$とする．このとき，値$8$から$6$を引いた値である$2$を記憶す
る．これを繰り返していくことによって最終的に$010100$が得られる．
これが$n = 6, k = 2$とした場合に$8$に対応する$x$ということになる．最終的
に$n =6, k = 2$の2進数列$x$の集合は10進数$i(x)$が表\ref{tab:shalkwijk}の
ように割り当てられる．

\begin{table}[h]
 \centering
 \caption{$n = 6, k = 2$の場合の対応付け}
 \label{tab:shalkwijk}
 \begin{tabular}{|c|c|c|c|} \hline
  $x$    & $i(x)$ & $x$    & $i(x)$ \\ \hline
  000011 & 0      & 010100 & 8      \\ \hline
  000101 & 1      & 011000 & 9      \\ \hline
  000110 & 2      & 100001 & 10     \\ \hline
  001001 & 3      & 100010 & 11     \\ \hline
  001010 & 4      & 100100 & 12     \\ \hline
  001100 & 5      & 101000 & 13     \\ \hline
  010001 & 6      & 110000 & 14     \\ \hline
  010010 & 7      &        &        \\ \hline
 \end{tabular}
\end{table}

}

\subsection{誤りパターンの動的生成\label{sec:dynamic_error_pt}}{
提案する誤りパターンの動的生成手法ではテキスト情報の各文字のバイナリ表現を2進数列
$x$として与えることで，10進数$i(x)$へと変換する．この変換は
\ref{sec:shalkwijk}で述べたパスカルの三角形を用いて行なう．
このとき，$x$が一意である一方で，異なる$x$に対し同じ$i(x)$が割り振ら
れる場合がある．例えば，表\ref{tab:shalkwijk}で$x = 000011$に割り当てら
れる$i(x)$は$0$であるが，$x = 000000$に対しても同様に$0$が割り当てられる．
そこで，本手法では$x$の長さ$n$，ハミング重み$k$を用いた式(\ref{eq:offset})で求め
られるoffset$_k$をi(x)に加算することで一意の誤りパターンとする．

\begin{equation}  % displaymath,eqnarray いずれも可能
 \begin{array}{l}
  \mbox{offset}_k = {\displaystyle \sum_{i=0}^{k-1}} {_n C_i} \\
  \mbox{offset}_0 = 0 
 \end{array}
 \label{eq:offset}
\end{equation}

この方法を用いることで誤りパターンを動的に生成し，強いメモリ制約下での誤
りパターン変換を可能とする．
}

\section{埋め込みによるカバーデータの劣化評価}
\subsection{実験手順} {
実験手順の概要を図\ref{fig:experiment1}に示す．以下に示す手順で実験を行った．実
験には256$\times$256pxの8ビットグレイスケールBitmapであるSIDBA画像30枚を
使用し，埋め込みに使用するテキスト情報は等確率で発生する8ビットコードの列と
した．テキスト情報の生成には623次元に分布する乱数発生器であるSFMTを用いた．

\begin{enumerate}
\renewcommand{\labelenumi}{(\arabic{enumi})}
 \item テキスト情報の各コードを\ref{sec:dynamic_error_pt}章にて述べた手
       法で動的に誤りパターンへと変換し，変換した誤りパターンと画像のLSB
       との排他的論理和を画像へと埋め込む．\label{enum:experiment1-1}
 \item 埋め込み前後の画像を比較し，誤り率，SSIMを算出する．\label{enum:experiment1-2}
 \item 誤りパターン長を8ビットから255ビットまで変化させ（\ref{enum:experiment1-1}），（\ref{enum:experiment1-2}）を繰り返す．\label{enum:experiment1-3}
 \item 画像を入れ替えて（\ref{enum:experiment1-3}）を繰り返す．
\end{enumerate}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/experiment01.png}
 \end{center}
 \caption{実験概要}
 \label{fig:experiment1}
\end{figure}

}

\subsection{実験結果}
\subsubsection{埋め込み率に対する誤り率}{
誤り率の計測結果と文献\cite{Paper01}において示されている誤りパターン埋め
込み法における誤り率の理論的下限曲線を図\ref{fig:graph_error_rate}に示す．
なお，誤りパターン埋め込み法における誤り率はカバーデータによらず等しいこ
とから，すべてのカバーデータに対し同じ曲線を描く．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_error.png}
 \end{center}
 \caption{埋め込み率に対する誤り率の変化}
 \label{fig:graph_error_rate}
\end{figure}

 図\ref{fig:graph_error_rate}より，実際に計測した誤り率は理論的下限曲線
と同様，埋め込み率が増加するとともに誤り率も増加し，理論的下限曲線に比べ
曲率の低い曲線を描いた．
}

\subsubsection{埋め込み率に対する画質劣化\label{sec:result_ssim1}}{
30枚のSIDBA画像のうち，SSIMの最も高い画像10枚と最も低い10枚の埋め込み率に対
するSSIMの変化を図\ref{fig:graph_ssim1}に示す．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_ssim_lsb_only.png}
 \end{center}
 \caption{埋め込み率に対するSSIMの変化（画像ごと）}
 \label{fig:graph_ssim1}
\end{figure}

図\ref{fig:graph_ssim1}よりすべての埋め込み率についてSSIMが0.99を上回って
いることがわかる．一般的にSSIMは0.98以上で埋め込み前後の画像の区別がつか
ないと言われていることから，埋め込みをLSB平面に限定した
場合，埋め込み率，誤り率によって画質が大きく劣化することはなく，視覚的な
隠蔽性に大きく影響を与えることはないというこ
とがわかる．同時に図\ref{fig:graph_ssim1}より，画像ごとにSSIMの変化の様
子が異なることがわかる．これについて，実験に使用した画像を主観的に観察し
たところ，図\ref{fig:best_ssim_image}のように画像全体の複雑度が高い画像
ほどSSIMの変化が小さく，一方で図\ref{fig:least_ssim_image}のように複
雑度の低い大きな領域を含む画像ほどSSIMの変化が大きくなるという傾向が見ら
れた．ここで複雑度とは，画像全体における画素間の明暗の変化の多さを表してお
り，複雑度が高いほどにノイズ画像に近くなる．これは，埋め込まれるデータ
内の0,1の発生はランダムであり，埋め込みによる画像の劣化がノイズ状に発生
することから，図\ref{fig:best_ssim_image}のように複雑度が高い画像であれ
ば，画像中にノイズが溶け込み，目立たなくなってしまうためであると考えられる．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/BRIDGE.png}
 \end{center}
 \caption{BRIDGE.bmp}
 \label{fig:best_ssim_image}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/Balloon.png}
 \end{center}
 \caption{Balloon.bmp}
 \label{fig:least_ssim_image}
\end{figure}
}

\subsubsection{２ビット列目以降へ埋め込んだ場合の画質劣化
   \label{sec:more_bit_prane}}{

章\ref{sec:result_ssim1}よりLSBのみへの埋め込みではステゴデータの劣化は
ほとんど起こらず，視覚的な隠蔽性には影響を与えないということがわかった．この
ことから隠蔽性に影響を与えない範囲で2ビット列目以降への埋め込みも可能
なのではないかと仮定し，2〜4ビット列目までの埋め込みを行った．実験手順は
これまでと同様の手順で行い，実験対象となるビット列より下位のビット列につ
いては埋め込み率100％での埋め込みを行った．実験結果をそれぞれ図
\ref{fig:graph_ssim2}〜\ref{fig:graph_ssim4}に示す．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_ssim_second_plane.png}
 \end{center}
 \caption{2ビット列目まで埋め込んだ場合}
 \label{fig:graph_ssim2}
\end{figure}

\begin{figure}[htbp]
 \centering
 \includegraphics[width=7.5cm]{img/graph_ssim_third_plain.png}
 \caption{3ビット列目まで埋め込んだ場合}
 \label{fig:graph_ssim3}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_ssim_fouth_plain.png}
 \end{center}
 \caption{4ビット列目まで埋め込んだ場合}
 \label{fig:graph_ssim4}
\end{figure}

図\ref{fig:graph_ssim2}より埋め込み率$0.9$前後でSSIMが$0.98$を下回り始め
ていることがわかる．このことから，LSBへの埋め込みを100％として2ビットプ
レーンまで埋め込みを行うことで，ほとんどの画像に対し，視覚的な隠蔽性に影
響を与えない範囲で，約1.9倍のテキスト情報の埋め込
みが可能であるといえる．

図\ref{fig:graph_ssim3}より３ビット列目まで埋め込み率100％での埋め込
みを行ったとしてもSSIMが0.98を上回る画像があることがわかる．また，図
\ref{fig:graph_ssim4}においても埋め込み率0.2前後までSSIMが0.98を上回って
いることがわかる．

ここで，図\ref{fig:best_ssim_image}，\ref{fig:least_ssim_image}のステゴ
データをそれぞれ図\ref{fig:best_ssim_image_emb}，
\ref{fig:least_ssim_image_emb}に示す．ステゴデータはLSBから3ビット列目ま
で埋め込み率100％で埋め込みを行ったものである．図
\ref{fig:least_ssim_image_emb}はもとの画像に比べ視覚的に大きく劣化が生じ
ており，一方図\ref{fig:best_ssim_image_emb}は劣化が小さく元の画像からほ
とんど変化していない．これらのことから適切な画像を選択することでよりLSB
のみへの埋め込みに比べ3倍以上のテキスト情報の埋め込みが可能になるといえ
る．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/8_7_BRIDGE.png}
 \end{center}
 \caption{BRIDGE.bmpのステゴデータ}
 \label{fig:best_ssim_image_emb}
\end{figure}

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7cm]{img/8_7_Balloon.png}
 \end{center}
 \caption{Balloon.bmpのステゴデータ}
 \label{fig:least_ssim_image_emb}
\end{figure}
}

\subsubsection{埋め込む文字数を一定にした場合の画質劣化}{
埋め込まれるテキスト情報の文字数を固定して誤りパターン長を長くした場合，
埋め込みに必要となるステゴビット列は長くなるが，ステゴデータの誤り率を下
げることができる．

例えば，LSBのみへ埋め込み率100％，すなわち誤りパターン長を8ビットとして埋
め込みを行った場合，256$\times$256pxの画像であれば8192文字のテキスト情報
の埋め込みが可能である．これに対し，誤りパターン長を16ビットとして8192文
字のテキスト情報を埋め込んだ場合，LSBに加え2ビット列目を使用する必要があ
るが，誤りパターン長が倍となることから誤り率を半減させることができる．

しかし，一般に誤り率を下げることで画質劣化を抑えることができるが，２ビッ
ト列目はLSBに比べ，各ビットが倍の情報量を持つことから誤りビットによるス
テゴデータの視覚的変化が大きくなる．

これについて，埋め込む文字数を固定し，LSBのみへ埋め込みを行った場合，LSB
に加え2ビット列目まで埋め込みを行った場合について，後者の場合により画質
劣化を抑えることができると仮定し，これまでと同様の実験手順でステゴデータ
の画質劣化の比較を行った．

実験で使用した30枚のSIDBA画像のうちBRIDGE.bmp（図
\ref{fig:best_ssim_image}）を使用した場合の実験結果を図
\ref{fig:graph_vs_same_message_length}に示す．図
\ref{fig:graph_vs_same_message_length}より，埋め込む文字数にかかわらず，
LSBに加え2ビット列にまで埋め込みを行った場合のSSIMがLSBのみに埋め込みを
行った場合のSSIMを下回っていることがわかる．この結果から，誤りパターン長
を長くしたとしても，より重みのあるビット使用した場合，画質劣化を抑えることはで
きないということがわかる．

\begin{figure}[htbp]
 \begin{center}
  \includegraphics[width=7.5cm]{img/graph_same_message_length.png}
 \end{center}
 \caption{埋め込み率に対する誤り率の変化}
 \label{fig:graph_vs_same_message_length}
\end{figure}
}

\section{実験環境}{
\begin{itemize}
 \item OS  : Mac OS X 8，9
 \item RAM : 8GB 1600 MHz DDR3
 \item IDE : Intellij IDEA 13.0
\end{itemize}
}

\section{画像の入手元} {
\begin{enumerate}
 \item 神奈川大学 \\
       \url{http://www.ess.ic.kanagawa-it.ac.jp/app_images_j.html}
 \item 京都大学 \\
       \url{http://vision.kuee.kyoto-u.ac.jp/IUE/IMAGE_DATABASE/STD_IMAGES/index.html}
 \item Ashi-LAB \\
       \url{http://asssy.sakura.ne.jp/idba.html}
 \item Rensselaer Polytechnic Institute \\
       \url{http://www.cipr.rpi.edu/resource/stills/index.html}
\end{enumerate}
}

\section{おわりに}{
 本研究では誤りパターン埋め込み法における埋め込み率と誤り率，画質劣化と
のトレードオフ関係を実験的に明らかにした．これによって，埋め込みをLSB平面に
限定した場合，埋め込み率，誤り率によって画質が大きく劣化することはなく，
ステゴデータの視覚的な隠蔽性に大きく影響を与えることはないということがわかった．さら
にこの結果を受け，LSBへの埋め込みを埋め込み率100％として２ビット列目以降
への埋め込みを行なったところ，２ビット列目を使用することでほとんどの画像
に対し1.9倍近くのテキスト情報の埋め込みが可能であること，３ビット列目以
降を使用した場合にも画像を適切に選択することで3倍以上ものテキスト情報の埋め
込みが可能であることを示した．

 また，Shalkwijkの数え上げ符号を用いた誤りパターンへの動的生成手法を提
案することで，強いメモリ制約下における誤りパターンテーブルの実装問題に対
する解決策を示した．しかし，本論文の実験で使用した環境は決してメモリ制約の強い
環境ではないため，今後実際に強いメモリ制約下での動作比較実験を行う必要が
あると思われる．
}

%-------------------------------------------references
\bibliographystyle{junsrt}
\bibliography{report}

\end{document}